<meta charset="utf8"><style>body,html{width:100vw;height:100vh;margin:0;padding:0;background-color:#2c1b2e}#d1{width:100vw;height:100vh;display:flex;align-items:center;justify-content:center}#d2{max-width:100vw;max-height:100vh;aspect-ratio:48/27}#canvas{width:100%;height:100%}</style><div id="d1"><div id="d2"><canvas id="canvas"></canvas></div></div><script>(function () {
  'use strict';

  /*

  ZzFX - Zuper Zmall Zound Zynth v1.1.8
  By Frank Force 2019
  https://github.com/KilledByAPixel/ZzFX

  ZzFX Features

  - Tiny synth engine with 20 controllable parameters.
  - Play sounds via code, no need for sound assed files!
  - Compatible with most modern web browsers.
  - Small code footprint, the micro version is under 1 kilobyte.
  - Can produce a huge variety of sound effect types.
  - Sounds can be played with a short call. zzfx(...[,,,,.1,,,,9])
  - A small bit of randomness appied to sounds when played.
  - Use ZZFX.GetNote to get frequencies on a standard diatonic scale.
  - Sounds can be saved out as wav files for offline playback.
  - No additional libraries or dependencies are required.

  */
  /*

    ZzFX MIT License

    Copyright (c) 2019 - Frank Force

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

  */


  // zzfx object with some extra functionalty
  const ZZFX = {
      // master volume scale
      volume: .3,

      // sample rate for audio
      sampleRate: 44100,

      // create shared audio context
      x: new (window.AudioContext || webkitAudioContext),

      destination: undefined,

      // play a sound from zzfx paramerters
      play: function(...parameters)
      {
          // build samples and start sound
          return this.playSamples(this.buildSamples(...parameters));
      },

      // play an array of samples
      playSamples: function(...samples)
      {
          // create buffer and source
          const buffer = this.x.createBuffer(samples.length, samples[0].length, this.sampleRate),
              source = this.x.createBufferSource();

          samples.map((d,i)=> buffer.getChannelData(i).set(d));
          source.buffer = buffer;
          source.connect(this.destination);
          source.start();
          return source;
      },

      // build an array of samples
      buildSamples: function
      (
          volume = 1,
          randomness = .05,
          frequency = 220,
          attack = 0,
          sustain = 0,
          release = .1,
          shape = 0,
          shapeCurve = 1,
          slide = 0,
          deltaSlide = 0,
          pitchJump = 0,
          pitchJumpTime = 0,
          repeatTime = 0,
          noise = 0,
          modulation = 0,
          bitCrush = 0,
          delay = 0,
          sustainVolume = 1,
          decay = 0,
          tremolo = 0
      )
      {
          // init parameters
          const PI2 = Math.PI*2;
          let sampleRate = this.sampleRate,
          sign = v => v>0?1:-1,
          startSlide = slide *= 500 * PI2 / sampleRate / sampleRate,
          startFrequency = frequency *=
              (1 + randomness*2*Math.random() - randomness) * PI2 / sampleRate,
          b=[], t=0, tm=0, i=0, j=1, r=0, c=0, s=0, f, length;

          // scale by sample rate
          attack = attack * sampleRate + 9; // minimum attack to prevent pop
          decay *= sampleRate;
          sustain *= sampleRate;
          release *= sampleRate;
          delay *= sampleRate;
          deltaSlide *= 500 * PI2 / sampleRate**3;
          modulation *= PI2 / sampleRate;
          pitchJump *= PI2 / sampleRate;
          pitchJumpTime *= sampleRate;
          repeatTime = repeatTime * sampleRate | 0;

          // generate waveform
          for(length = attack + decay + sustain + release + delay | 0;
              i < length; b[i++] = s)
          {
              if (!(++c%(bitCrush*100|0)))                      // bit crush
              {
                  s = shape? shape>1? shape>2? shape>3?         // wave shape
                      Math.sin((t%PI2)**3) :                    // 4 noise
                      Math.max(Math.min(Math.tan(t),1),-1):     // 3 tan
                      1-(2*t/PI2%2+2)%2:                        // 2 saw
                      1-4*Math.abs(Math.round(t/PI2)-t/PI2):    // 1 triangle
                      Math.sin(t);                              // 0 sin

                  s = (repeatTime ?
                          1 - tremolo + tremolo*Math.sin(PI2*i/repeatTime) // tremolo
                          : 1) *
                      sign(s)*(Math.abs(s)**shapeCurve) *       // curve 0=square, 2=pointy
                      volume * this.volume * (                  // envelope
                      i < attack ? i/attack :                   // attack
                      i < attack + decay ?                      // decay
                      1-((i-attack)/decay)*(1-sustainVolume) :  // decay falloff
                      i < attack  + decay + sustain ?           // sustain
                      sustainVolume :                           // sustain volume
                      i < length - delay ?                      // release
                      (length - i - delay)/release *            // release falloff
                      sustainVolume :                           // release volume
                      0);                                       // post release

                  s = delay ? s/2 + (delay > i ? 0 :            // delay
                      (i<length-delay? 1 : (length-i)/delay) *  // release delay
                      b[i-delay|0]/2) : s;                      // sample delay
              }

              f = (frequency += slide += deltaSlide) *          // frequency
                  Math.cos(modulation*tm++);                    // modulation
              t += f - f*noise*(1 - (Math.sin(i)+1)*1e9%2);     // noise

              if (j && ++j > pitchJumpTime)       // pitch jump
              {
                  frequency += pitchJump;         // apply pitch jump
                  startFrequency += pitchJump;    // also apply to start
                  j = 0;                          // stop pitch jump time
              }

              if (repeatTime && !(++r % repeatTime)) // repeat
              {
                  frequency = startFrequency;     // reset frequency
                  slide = startSlide;             // reset slide
                  j = j || 1;                     // reset pitch jump time
              }
          }

          return b;
      },

      // get frequency of a musical note on a diatonic scale
      getNote: function(semitoneOffset=0, rootNoteFrequency=440)
      {
          return rootNoteFrequency * 2**(semitoneOffset/12);
      }

  }; // ZZFX

  /* -*- mode: javascript; tab-width: 4; indent-tabs-mode: nil; -*-
  *
  * Copyright (c) 2011-2013 Marcus Geelnard
  *
  * This software is provided 'as-is', without any express or implied
  * warranty. In no event will the authors be held liable for any damages
  * arising from the use of this software.
  *
  * Permission is granted to anyone to use this software for any purpose,
  * including commercial applications, and to alter it and redistribute it
  * freely, subject to the following restrictions:
  *
  * 1. The origin of this software must not be misrepresented; you must not
  *    claim that you wrote the original software. If you use this software
  *    in a product, an acknowledgment in the product documentation would be
  *    appreciated but is not required.
  *
  * 2. Altered source versions must be plainly marked as such, and must not be
  *    misrepresented as being the original software.
  *
  * 3. This notice may not be removed or altered from any source
  *    distribution.
  *
  */


  // Some general notes and recommendations:
  //  * This code uses modern ECMAScript features, such as ** instead of
  //    Math.pow(). You may have to modify the code to make it work on older
  //    browsers.
  //  * If you're not using all the functionality (e.g. not all oscillator types,
  //    or certain effects), you can reduce the size of the player routine even
  //    further by deleting the code.


  const CPlayer = function() {

      //--------------------------------------------------------------------------
      // Private methods
      //--------------------------------------------------------------------------

      // Oscillators
      var osc_sin = function (value) {
          return Math.sin(value * 6.283184);
      };

      var osc_saw = function (value) {
          return 2 * (value % 1) - 1;
      };

      var osc_square = function (value) {
          return (value % 1) < 0.5 ? 1 : -1;
      };

      var osc_tri = function (value) {
          var v2 = (value % 1) * 4;
          if(v2 < 2) return v2 - 1;
          return 3 - v2;
      };

      var getnotefreq = function (n) {
          // 174.61.. / 44100 = 0.003959503758 (F3)
          return 0.003959503758 * (2 ** ((n - 128) / 12));
      };

      var createNote = function (instr, n, rowLen) {
          var osc1 = mOscillators[instr.i[0]],
              o1vol = instr.i[1],
              o1xenv = instr.i[3]/32,
              osc2 = mOscillators[instr.i[4]],
              o2vol = instr.i[5],
              o2xenv = instr.i[8]/32,
              noiseVol = instr.i[9],
              attack = instr.i[10] * instr.i[10] * 4,
              sustain = instr.i[11] * instr.i[11] * 4,
              release = instr.i[12] * instr.i[12] * 4,
              releaseInv = 1 / release,
              expDecay = -instr.i[13]/16,
              arp = instr.i[14],
              arpInterval = rowLen * (2 **(2 - instr.i[15]));

          var noteBuf = new Int32Array(attack + sustain + release);

          // Re-trig oscillators
          var c1 = 0, c2 = 0;

          // Local variables.
          var j, j2, e, rsample, o1t, o2t;

          // Generate one note (attack + sustain + release)
          for (j = 0, j2 = 0; j < attack + sustain + release; j++, j2++) {
              if (j2 >= 0) {
                  // Switch arpeggio note.
                  arp = (arp >> 8) | ((arp & 255) << 4);
                  j2 -= arpInterval;

                  // Calculate note frequencies for the oscillators
                  o1t = getnotefreq(n + (arp & 15) + instr.i[2] - 128);
                  o2t = getnotefreq(n + (arp & 15) + instr.i[6] - 128) * (1 + 0.0008 * instr.i[7]);
              }

              // Envelope
              e = 1;
              if (j < attack) {
                  e = j / attack;
              } else if (j >= attack + sustain) {
                  e = (j - attack - sustain) * releaseInv;
                  e = (1 - e) * (3 ** (expDecay * e));
              }

              // Oscillator 1
              c1 += o1t * e ** o1xenv;
              rsample = osc1(c1) * o1vol;

              // Oscillator 2
              c2 += o2t * e ** o2xenv;
              rsample += osc2(c2) * o2vol;

              // Noise oscillator
              if (noiseVol) {
                  rsample += (2 * Math.random() - 1) * noiseVol;
              }

              // Add to (mono) channel buffer
              noteBuf[j] = (80 * rsample * e) | 0;
          }

          return noteBuf;
      };


      //--------------------------------------------------------------------------
      // Private members
      //--------------------------------------------------------------------------

      // Array of oscillator functions
      var mOscillators = [
          osc_sin,
          osc_square,
          osc_saw,
          osc_tri
      ];

      // Private variables set up by init()
      var mSong, mLastRow, mCurrentCol, mNumWords, mMixBuf, mChannelBufs;


      //--------------------------------------------------------------------------
      // Initialization
      //--------------------------------------------------------------------------

      this.init = function (song) {
          // Define the song
          mSong = song;

          // Init iteration state variables
          mLastRow = song.endPattern;
          mCurrentCol = 0;

          // Prepare song info
          mNumWords =  song.rowLen * song.patternLen * (mLastRow + 1) * 2;

          // Create work buffer (initially cleared)
          mMixBuf = new Int32Array(mNumWords);

          mChannelBufs = [];

          for (let i = 0; i < song.numChannels; i++) {
              mChannelBufs.push(new Int32Array(mNumWords));
          }
      };


      //--------------------------------------------------------------------------
      // Public methods
      //--------------------------------------------------------------------------

      // Generate audio data for a single track
      this.generate = function () {
          // Local variables
          var i, j, p, row, col, n, cp,
              k, t, rsample, rowStartSample, f;

          // Put performance critical items in local variables
          var chnBuf = new Int32Array(mNumWords),
              instr = mSong.songData[mCurrentCol],
              rowLen = mSong.rowLen,
              patternLen = mSong.patternLen;

          // Clear effect state
          var low = 0, band = 0, high;
          var lsample, filterActive = false;

          // Clear note cache.
          var noteCache = [];

           // Patterns
           for (p = 0; p <= mLastRow; ++p) {
              cp = instr.p[p];

              // Pattern rows
              for (row = 0; row < patternLen; ++row) {
                  // Execute effect command.
                  var cmdNo = cp ? instr.c[cp - 1].f[row] : 0;
                  if (cmdNo) {
                      instr.i[cmdNo - 1] = instr.c[cp - 1].f[row + patternLen] || 0;

                      // Clear the note cache since the instrument has changed.
                      if (cmdNo < 17) {
                          noteCache = [];
                      }
                  }

                  // Put performance critical instrument properties in local variables
                  var oscLFO = mOscillators[instr.i[16]],
                      lfoAmt = instr.i[17] / 512,
                      lfoFreq = (2 ** (instr.i[18] - 9)) / rowLen,
                      fxLFO = instr.i[19],
                      fxFilter = instr.i[20],
                      fxFreq = instr.i[21] * 43.23529 * 3.141592 / 44100,
                      q = 1 - instr.i[22] / 255,
                      dist = instr.i[23] * 1e-5,
                      drive = instr.i[24] / 32,
                      panAmt = instr.i[25] / 512,
                      panFreq = 6.283184 * (2 ** (instr.i[26] - 9)) / rowLen,
                      dlyAmt = instr.i[27] / 255,
                      dly = instr.i[28] * rowLen & -2;  // Must be an even number

                  // Calculate start sample number for this row in the pattern
                  rowStartSample = (p * patternLen + row) * rowLen;

                  // Generate notes for this pattern row
                  for (col = 0; col < 4; ++col) {
                      n = cp ? instr.c[cp - 1].n[row + col * patternLen] : 0;
                      if (n) {
                          if (!noteCache[n]) {
                              noteCache[n] = createNote(instr, n, rowLen);
                          }

                          // Copy note from the note cache
                          var noteBuf = noteCache[n];
                          for (j = 0, i = rowStartSample * 2; j < noteBuf.length; j++, i += 2) {
                            chnBuf[i] += noteBuf[j];
                          }
                      }
                  }

                  // Perform effects for this pattern row
                  for (j = 0; j < rowLen; j++) {
                      // Dry mono-sample
                      k = (rowStartSample + j) * 2;
                      rsample = chnBuf[k];

                      // We only do effects if we have some sound input
                      if (rsample || filterActive) {
                          // State variable filter
                          f = fxFreq;
                          if (fxLFO) {
                              f *= oscLFO(lfoFreq * k) * lfoAmt + 0.5;
                          }
                          f = 1.5 * Math.sin(f);
                          low += f * band;
                          high = q * (rsample - band) - low;
                          band += f * high;
                          rsample = fxFilter == 3 ? band : fxFilter == 1 ? high : low;

                          // Distortion
                          if (dist) {
                              rsample *= dist;
                              rsample = rsample < 1 ? rsample > -1 ? osc_sin(rsample*.25) : -1 : 1;
                              rsample /= dist;
                          }

                          // Drive
                          rsample *= drive;

                          // Is the filter active (i.e. still audiable)?
                          filterActive = rsample * rsample > 1e-5;

                          // Panning
                          t = Math.sin(panFreq * k) * panAmt + 0.5;
                          lsample = rsample * (1 - t);
                          rsample *= t;
                      } else {
                          lsample = 0;
                      }

                      // Delay is always done, since it does not need sound input
                      if (k >= dly) {
                          // Left channel = left + right[-p] * t
                          lsample += chnBuf[k-dly+1] * dlyAmt;

                          // Right channel = right + left[-p] * t
                          rsample += chnBuf[k-dly] * dlyAmt;
                      }

                      // Store in stereo channel buffer (needed for the delay effect)
                      chnBuf[k] = lsample | 0;
                      chnBuf[k+1] = rsample | 0;

                      // ...and add to stereo mix buffer
                      mMixBuf[k] += lsample | 0;
                      mMixBuf[k+1] += rsample | 0;

                      // ...and channel
                      mChannelBufs[mCurrentCol][k] += lsample | 0;
                      mChannelBufs[mCurrentCol][k+1] += rsample | 0;
                  }
              }
          }

          // Next iteration. Return progress (1.0 == done!).
          mCurrentCol++;
          return mCurrentCol / mSong.numChannels;
      };

      // Create a AudioBuffer from the generated audio data
      this.createAudioBuffer = function(context, channelNumber) {
          let source = channelNumber === undefined ? mMixBuf : mChannelBufs[channelNumber];

          var buffer = context.createBuffer(2, mNumWords / 2, 44100);
          for (var i = 0; i < 2; i ++) {
              var data = buffer.getChannelData(i);
              for (var j = i; j < mNumWords; j += 2) {
                  data[j >> 1] = source[j] / 65536;
              }
          }

          return buffer;
      };

      // Create a WAVE formatted Uint8Array from the generated audio data
      this.createWave = function() {
          // Create WAVE header
          var headerLen = 44;
          var l1 = headerLen + mNumWords * 2 - 8;
          var l2 = l1 - 36;
          var wave = new Uint8Array(headerLen + mNumWords * 2);
          wave.set(
              [82,73,70,70,
               l1 & 255,(l1 >> 8) & 255,(l1 >> 16) & 255,(l1 >> 24) & 255,
               87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,
               68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,
               l2 & 255,(l2 >> 8) & 255,(l2 >> 16) & 255,(l2 >> 24) & 255]
          );

          // Append actual wave data
          for (var i = 0, idx = headerLen; i < mNumWords; ++i) {
              // Note: We clamp here
              var y = mMixBuf[i];
              y = y < -32767 ? -32767 : (y > 32767 ? 32767 : y);
              wave[idx++] = y & 255;
              wave[idx++] = (y >> 8) & 255;
          }

          // Return the WAVE formatted typed array
          return wave;
      };

      // Get n samples of wave data at time t [s]. Wave data in range [-2,2].
      this.getData = function(t, n) {
          var i = 2 * Math.floor(t * 44100);
          var d = new Array(n);
          for (var j = 0; j < 2*n; j += 1) {
              var k = i + j;
              d[j] = t > 0 && k < mMixBuf.length ? mMixBuf[k] / 32768 : 0;
          }
          return d;
      };
  };

  // Song: ThirteenthCenturyVibes
  //
  // You can load this in SoundBox using the binary export, see the ".sbox"
  // file of the same name in src/assets folder.

      // This music has been exported by SoundBox. You can use it with
      // http://sb.bitsnbites.eu/player-small.js in your own product.

      // See http://sb.bitsnbites.eu/demo.html for an example of how to
      // use it in a demo.

      // This music has been exported by SoundBox. You can use it with
      // http://sb.bitsnbites.eu/player-small.js in your own product.

      // See http://sb.bitsnbites.eu/demo.html for an example of how to
      // use it in a demo.

      // Song data
      const song = {
        songData: [
          { // Instrument 0
            i: [
            1, // OSC1_WAVEFORM
            192, // OSC1_VOL
            128, // OSC1_SEMI
            0, // OSC1_XENV
            1, // OSC2_WAVEFORM
            191, // OSC2_VOL
            116, // OSC2_SEMI
            9, // OSC2_DETUNE
            0, // OSC2_XENV
            0, // NOISE_VOL
            6, // ENV_ATTACK
            22, // ENV_SUSTAIN
            34, // ENV_RELEASE
            0, // ENV_EXP_DECAY
            0, // ARP_CHORD
            0, // ARP_SPEED
            0, // LFO_WAVEFORM
            69, // LFO_AMT
            3, // LFO_FREQ
            1, // LFO_FX_FREQ
            1, // FX_FILTER
            23, // FX_FREQ
            167, // FX_RESONANCE
            0, // FX_DIST
            32, // FX_DRIVE
            77, // FX_PAN_AMT
            6, // FX_PAN_FREQ
            7, // FX_DELAY_AMT
            6 // FX_DELAY_TIME
            ],
            // Patterns
            p: [,,2,2,2,2,1,1,1,3,1,1,1,3,4,1,4,3,1,1,1,3,1,1,1,5],
            // Columns
            c: [
              {n: [125,137,125,,,,125,,130,,130,,125,,,,125,125,125,,,,125,,130,,130,,125,,,,128,,128,140,,,128,,134,,134,,,128,,,128,,128,128,,,128,,134,,134,,,128,,,132,,132,,134,,132,,125,,125,,,,130,,132,,132,,134,,132,,125,,125,,,135,130,,,,,134,,,,,,,,,,,,132,,,,134,,,,,,142,,144,,,,132],
               f: []},
              {n: [125,,125,,,,125,,130,,130,,125,,,,125,,125,,,,125,,130,,130,,125,,,,128,,128,,,,128,,134,,134,,,,,,128,,128,128,,,128,,134,,134,,,128,,,132,,132,,134,,132,,125,,125,,,,,,132,,132,,134,,132,,125,,125,,,,130,,,,,,,,,,,,,,,,,,,,,,,,,,,,,144],
               f: []},
              {n: [125,137,125,,,,125,,130,,130,,125,,,,144,,144,,142,,142,,140,,140,,137,,137,,128,,128,140,,,128,,134,,134,,,128,,,,132,,132,,130,,130,,128,,128,,125,,125,132,,132,,134,,132,,125,,125,,,,130,,,,,,,,,,,,,,,,,,,,,134,,,,,,,,,,,,132],
               f: []},
              {n: [125,137,125,,,,125,,,,130,,125,,,,125,125,125,,,,125,,130,,130,,132,,,,128,,128,140,,,,123,,,134,,,128,,,128,,128,128,,,128,,134,,134,,,130,,,132,,132,,134,,128,,128,,125,,,,130,,132,,132,,134,,132,,125,,125,,,,128,,,,,134,,,,,,130,,,,,,132,,,,134,,,,123,,125,,127,,,,123],
               f: []},
              {n: [125,,125,,,,125,,130,,,,125,,,,144,,144,,142,,142,,140,,140,,137,,137,,128,,128,140,,,128,,134,,,,,128,,,,132,,,,130,,,,128,,,,125,,,132,,132,,,,132,,125,,,,,,,,,,,,,,,,,,,,,,,,,,,134],
               f: []}
            ]
          },
          { // Instrument 1
            i: [
            3, // OSC1_WAVEFORM
            100, // OSC1_VOL
            128, // OSC1_SEMI
            0, // OSC1_XENV
            3, // OSC2_WAVEFORM
            201, // OSC2_VOL
            128, // OSC2_SEMI
            2, // OSC2_DETUNE
            0, // OSC2_XENV
            0, // NOISE_VOL
            0, // ENV_ATTACK
            6, // ENV_SUSTAIN
            49, // ENV_RELEASE
            0, // ENV_EXP_DECAY
            0, // ARP_CHORD
            0, // ARP_SPEED
            0, // LFO_WAVEFORM
            139, // LFO_AMT
            4, // LFO_FREQ
            1, // LFO_FX_FREQ
            3, // FX_FILTER
            30, // FX_FREQ
            184, // FX_RESONANCE
            119, // FX_DIST
            244, // FX_DRIVE
            147, // FX_PAN_AMT
            6, // FX_PAN_FREQ
            24, // FX_DELAY_AMT
            6 // FX_DELAY_TIME
            ],
            // Patterns
            p: [2,3,2,2,2,2,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3],
            // Columns
            c: [
              {n: [],
               f: []},
              {n: [113,,113,,113,,113,,118,,118,,118,,118,,113,,113,,113,,113,,118,,118,,118,,118],
               f: []},
              {n: [113,,113,,113,,113,,118,,118,,118,,118,,113,,111,,113,,115,,116,,118,,120,,122],
               f: []}
            ]
          },
          { // Instrument 2
            i: [
            0, // OSC1_WAVEFORM
            0, // OSC1_VOL
            128, // OSC1_SEMI
            0, // OSC1_XENV
            0, // OSC2_WAVEFORM
            0, // OSC2_VOL
            128, // OSC2_SEMI
            0, // OSC2_DETUNE
            0, // OSC2_XENV
            125, // NOISE_VOL
            0, // ENV_ATTACK
            1, // ENV_SUSTAIN
            59, // ENV_RELEASE
            0, // ENV_EXP_DECAY
            0, // ARP_CHORD
            0, // ARP_SPEED
            0, // LFO_WAVEFORM
            0, // LFO_AMT
            0, // LFO_FREQ
            0, // LFO_FX_FREQ
            1, // FX_FILTER
            193, // FX_FREQ
            171, // FX_RESONANCE
            0, // FX_DIST
            29, // FX_DRIVE
            39, // FX_PAN_AMT
            3, // FX_PAN_FREQ
            88, // FX_DELAY_AMT
            3 // FX_DELAY_TIME
            ],
            // Patterns
            p: [,,,,,,4,4,4,5,4,4,4,5,,,4,5,4,4,4,5,4,4,4],
            // Columns
            c: [
              {n: [],
               f: []},
              {n: [],
               f: []},
              {n: [],
               f: []},
              {n: [113,,,,,,,,113,,,,,,,,113,,,,,,,,113],
               f: []},
              {n: [113,,,,,,,,113,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,113,,,,113,,,,113,,,,113,113,113],
               f: []}
            ]
          },
          { // Instrument 3
            i: [
            0, // OSC1_WAVEFORM
            160, // OSC1_VOL
            128, // OSC1_SEMI
            64, // OSC1_XENV
            0, // OSC2_WAVEFORM
            160, // OSC2_VOL
            128, // OSC2_SEMI
            0, // OSC2_DETUNE
            64, // OSC2_XENV
            210, // NOISE_VOL
            4, // ENV_ATTACK
            7, // ENV_SUSTAIN
            52, // ENV_RELEASE
            85, // ENV_EXP_DECAY
            0, // ARP_CHORD
            0, // ARP_SPEED
            0, // LFO_WAVEFORM
            60, // LFO_AMT
            4, // LFO_FREQ
            1, // LFO_FX_FREQ
            2, // FX_FILTER
            255, // FX_FREQ
            0, // FX_RESONANCE
            0, // FX_DIST
            32, // FX_DRIVE
            61, // FX_PAN_AMT
            5, // FX_PAN_FREQ
            32, // FX_DELAY_AMT
            6 // FX_DELAY_TIME
            ],
            // Patterns
            p: [4,4,4,5,4,5,4,4,4,5,4,4,4,5,4,4,4,5,4,4,4,5,4,4,4,5],
            // Columns
            c: [
              {n: [],
               f: []},
              {n: [],
               f: []},
              {n: [],
               f: []},
              {n: [,,,,113,,,,,,,,113,,,,,,,,113,,,,,,,,113],
               f: []},
              {n: [,,,,113,,,,,,,,113,,,,113,,,,113,,,,113,,,,113],
               f: []}
            ]
          },
          { // Instrument 4
            i: [
            0, // OSC1_WAVEFORM
            0, // OSC1_VOL
            140, // OSC1_SEMI
            0, // OSC1_XENV
            0, // OSC2_WAVEFORM
            0, // OSC2_VOL
            140, // OSC2_SEMI
            0, // OSC2_DETUNE
            0, // OSC2_XENV
            81, // NOISE_VOL
            4, // ENV_ATTACK
            10, // ENV_SUSTAIN
            47, // ENV_RELEASE
            55, // ENV_EXP_DECAY
            0, // ARP_CHORD
            0, // ARP_SPEED
            0, // LFO_WAVEFORM
            187, // LFO_AMT
            5, // LFO_FREQ
            0, // LFO_FX_FREQ
            1, // FX_FILTER
            239, // FX_FREQ
            135, // FX_RESONANCE
            0, // FX_DIST
            32, // FX_DRIVE
            108, // FX_PAN_AMT
            5, // FX_PAN_FREQ
            16, // FX_DELAY_AMT
            4 // FX_DELAY_TIME
            ],
            // Patterns
            p: [,4,4,5,4,5,4,4,4,5,4,4,4,5,,,4,5,4,4,4,5,4,4,4],
            // Columns
            c: [
              {n: [],
               f: []},
              {n: [],
               f: []},
              {n: [],
               f: []},
              {n: [,113,113,,,113,,,,113,113,,,113,,,,113,113,,,113,,,,113,113,,,113],
               f: []},
              {n: [,113,113,,,113,,,,113,113,,,113,,,113,,113,,113,,113,,113,,113,,113,,113,,,,,,,,,,,,,,,,,,,,,,,,,,,113,,,,113],
               f: []}
            ]
          },
        ],
        rowLen: 5513,   // In sample lengths
        patternLen: 32,  // Rows per pattern
        endPattern: 25,  // End pattern
        numChannels: 5  // Number of channels
      };

  // Audio


  const Audio = {
      init() {
          Audio.contextCreated = false;
          Audio.readyToPlay = false;
          Audio.musicEnabled = true;
          Audio.sfxEnabled = true;
          Audio.musicVolume = 0;
          Audio.sfxVolume = 0;

          Audio.levelStart = [5.02,,7,,,.18,,.37,,25,124,.03,.03,,,,.13,.35,.01]; // Random 807

          Audio.playerJump = [,,315,,.08,.07,,.77,-16,,,,,,,,,.91,.01];
          Audio.playerLand = [1.33,,423,.01,,.06,2,2.64,-3.8,,,,,.1,,.2,,.54,.01]; // Hit 491
          Audio.playerDeath = [1.11,,779,.01,.2,.48,4,4.56,.4,,,,.02,.9,,1,,.34,.13]; // Explosion 566
          Audio.playerSlam = [2.05,,374,.01,.05,.02,2,.59,-8.2,,,,,,,.5,.29,.65,.09]; // Shoot 673

          Audio.littleJump = [1.01,,491,,.01,.05,,1.02,25,,,,,,,.1,,.45,.08]; // Jump 438
          Audio.littleEscape = [,,433,.01,.18,.24,,.51,,,418,,.06,.1,,,,.43,.25,.11]; // Powerup 426

          Audio.enemyDeath = [1.81,,135,.01,.04,.18,1,.11,-6.6,,,,,.2,,.3,.15,.74,.09]; // Hit 569
      },

      initContext() {
          if (Audio.contextCreated) return;

          // In Safari, ensure our target AudioContext is created inside a
          // click or tap event (this ensures we don't interact with it until
          // after user input).
          //
          // Chrome and Firefox are more relaxed, but this approach works for all 3.
          ZZFX.x = Audio.ctx = new AudioContext();
          Audio.gain_ = Audio.ctx.createGain();
          Audio.gain_.connect(Audio.ctx.destination);
          ZZFX.destination = Audio.gain_;

          Audio.contextCreated = true;
      },

      initTracks() {
          // In this game, we ensure the screen that calls this function happens after the
          // user has interacted at least once (and that interaction called initContext above),
          // so we know it's safe to interact with the audio context.
          if (!Audio.musicPlaying) {
              this.player = new CPlayer();
              this.player.init(song);

              for (;;) {
                  if (this.player.generate() === 1) break;
              }

              this.musicGainNodes = [];
              this.songSources = [];

              for (let i = 0; i < song.numChannels; i++) {
                  let buffer = this.player.createAudioBuffer(Audio.ctx, i);
                  this.songSource = Audio.ctx.createBufferSource();

                  let gainNode = Audio.ctx.createGain();
                  gainNode.connect(Audio.gain_);
                  this.musicGainNodes.push(gainNode);

                  /*if (i === TRACK_COMBAT || i === TRACK_WAVE) {
                      gainNode.gain.value = 0;
                  }*/

                  this.songSource.buffer = buffer;
                  this.songSource.loop = true;
                  this.songSource.connect(gainNode);
                  this.songSources.push(this.songSource);
              }

              this.musicStartTime = Audio.ctx.currentTime + 0.1;

              for (let i = 0; i < song.numChannels; i++) {
                  this.songSources[i].start(this.musicStartTime);
                  // comment out music
              }

              Audio.musicPlaying = true;
          }

          Audio.readyToPlay = true;
      },

      update() {
          if (!Audio.readyToPlay) return;

          this.sfxVolume = this.sfxEnabled ? 0.3 : 0;
          this.musicVolume = this.musicEnabled ? 1 : 0;

          ZZFX.volume = this.sfxVolume;

          if (this.sfxEnabled) {
              ZZFX.volume = 0.3;
          } else {
              ZZFX.volume = 0;
          }
      },

      play(sound) {
          if (!Audio.readyToPlay) return;
          ZZFX.play(...sound);
      },

      // It's important we do pausing and unpausing as specific events and not in general update(),
      // because update() is triggered by the animation frame trigger which does not run if the
      // page is not visible. (So, if you want the music to fade in the background, for example,
      // that's not helpful if it won't work because you aren't looking at the page!)

      pause() {
          if (Audio.readyToPlay) {
              Audio.gain_.gain.linearRampToValueAtTime(0, Audio.ctx.currentTime + 1);
          }
      },

      unpause() {
          if (Audio.readyToPlay) {
              Audio.gain_.gain.linearRampToValueAtTime(1, Audio.ctx.currentTime + 1);
          }
      }
  };

  // Constants


  // The game's desired dimensions in pixels - the actual dimensions can be adjusted
  // slightly by the Viewport module.
  const TARGET_GAME_WIDTH = 320;
  const TARGET_GAME_HEIGHT = 180;

  // Size in pixels of each map tile
  const TILE_SIZE = 8;

  // Some pre-calculated radian values
  const R0          =   0;
  const R45         =  45 * Math.PI / 180;
  const R90         =  90 * Math.PI / 180;

  // Frames per second (locked)
  //
  // Other constants below, like gravity, foot speed, etc., are represented as movement PER FRAME.
  const FPS = 42;

  // Player movement constants
  const PLAYER_FOOT_SPEED = 1.3;
  const JUMP_HEIGHT = 3.5 * TILE_SIZE;
  const JUMP_HEIGHT_DISTANCE = 2 * TILE_SIZE;
  const JUMP_VELOCITY = -2 * JUMP_HEIGHT * PLAYER_FOOT_SPEED / JUMP_HEIGHT_DISTANCE;

  // Gravity
  const GRAVITY = 2 * JUMP_HEIGHT * PLAYER_FOOT_SPEED * PLAYER_FOOT_SPEED / (JUMP_HEIGHT_DISTANCE * JUMP_HEIGHT_DISTANCE);
  const TERMINAL_VELOCITY = 5;

  // If the bounding box of a jumping character hits a platform and the feet of
  // the character are within this many pixels of the top of the floor, pretend
  // that they "made the jump".
  const JUMP_CHEAT_Y_PIXELS = 2;

  // Tapping jump before you've landed will trigger another jump if you're
  // "about" to land on the ground (within this many frames).
  const JUMP_CHEAT_LANDING_FRAMES = 8;

  // How many pixels you must fall to super slam
  const SUPER_SLAM_FALL_DISTANCE = 72;

  // How many pixels away can you slam/bounce enemies?
  const SLAM_ENEMY_DISTANCE = 24;

  // KeyboardAdapter


  const KeyboardAdapter = {
      init() {
          KeyboardAdapter.map = {
              KeyW:        Input.Action.UP,
              KeyA:        Input.Action.LEFT,
              KeyS:        Input.Action.DOWN,
              KeyD:        Input.Action.RIGHT,
              Space:       Input.Action.JUMP,
              Enter:       Input.Action.CONTINUE,
              ArrowUp:     Input.Action.UP,
              ArrowLeft:   Input.Action.LEFT,
              ArrowDown:   Input.Action.DOWN,
              ArrowRight:  Input.Action.RIGHT,
              Escape:      Input.Action.MENU
          };

          // For keyboard, we support 8-point movement (S, E, SE, etc.)
          KeyboardAdapter.arrowDirections = [
              { x:   R0, y:   R0, m: 0 },
              { x:   R0, y: -R90, m: 1 },
              { x:   R0, y:  R90, m: 1 },
              { x:   R0, y:   R0, m: 0 },
              { x: -R90, y:   R0, m: 1 },
              { x: -R45, y: -R45, m: 1 },
              { x: -R45, y:  R45, m: 1 },
              { x: -R90, y:   R0, m: 1 },
              { x:  R90, y:   R0, m: 1 },
              { x:  R45, y: -R45, m: 1 },
              { x:  R45, y:  R45, m: 1 },
              { x:  R90, y:   R0, m: 1 },
              { x:   R0, y:   R0, m: 0 },
              { x:   R0, y: -R90, m: 1 },
              { x:   R0, y:  R90, m: 1 },
              { x:   R0, y:   R0, m: 0 }
          ];

          KeyboardAdapter.held = [];

          window.addEventListener('keydown', event => {
              let k = KeyboardAdapter.map[event.code];
              // Uncomment to debug key presses
              // console.log(event.key, event.keyCode, event.code, k);

              // Hack to ensure we initialize audio after user interacts with game
              Audio.initContext();

              if (k) {
                  KeyboardAdapter.held[k] = true;
              }
          });

          window.addEventListener('keyup', event => {
              let k = KeyboardAdapter.map[event.code];
              if (k) {
                  KeyboardAdapter.held[k] = false;
              }

              if (event.key >= '1' && event.key <= '9') {
                  game.nextLevel = Number(event.key) - 1;
                  game.screens.pop();
              }
          });

          KeyboardAdapter.reset();
      },

      update() {
          // For keyboards, we want to convert the state of the various arrow keys being held down
          // into a directional vector. We use the browser's event to handle the held state of
          // the other action buttons, so we don't need to process them here.
          let state =
              (KeyboardAdapter.held[Input.Action.UP] ? 1 : 0) +
              (KeyboardAdapter.held[Input.Action.DOWN] ? 2 : 0) +
              (KeyboardAdapter.held[Input.Action.LEFT] ? 4 : 0) +
              (KeyboardAdapter.held[Input.Action.RIGHT] ? 8 : 0);

          KeyboardAdapter.direction = KeyboardAdapter.arrowDirections[state];
      },

      reset() {
          KeyboardAdapter.direction = KeyboardAdapter.arrowDirections[0];
          for (let action of Object.values(Input.Action)) {
              KeyboardAdapter.held[action] = false;
          }
      }
  };

  // Input


  const Input = {
      // Game Inputs
      //
      // Note that moving the player around is actually not considered an action; it's
      // a separate non-action input called "direction". It just so happens that on
      // keyboard, for example, pressing the "down arrow" key is considered both a
      // press of the in-game DOWN action and a directional input. It's up to the input
      // consumer to decide which input is relevant (if any). For example, on a menu,
      // we may consume the DOWN/UP actions to navigate the menu, but ignore directional
      // inputs.
      //
      Action: {
          UP: 11,
          DOWN: 12,
          LEFT: 13,
          RIGHT: 14,
          JUMP: 22,
          ATTACK: 21,
          RELOAD: 30,
          CONTINUE: 95,
          MENU: 96,
          MUSIC_TOGGLE: 97,
          SFX_TOGGLE: 98,
          RAW_TOUCH: 40,
          DRAG: 41,
          TAP: 42
      },

      init() {
          // A vector representing the direction the user is pressing/facing,
          // separate from pressing and releasing inputs. Treating "direction"
          // separately makes it easier to handle gamepad sticks.
          this.direction = { x: 0, y: 0, m: 0 };

          // "Pressed" means an input was pressed THIS FRAME.
          this.pressed = {};

          // "Released" means an input was released THIS FRAME.
          this.released = {};

          // "Held" means an input is held down. The input was "Pressed" either
          // this frame or in a past frame, and has not been "Released" yet.
          this.held = {};

          // How many frames was this input held down by the player. If [held]
          // is false, it represents how long the input was last held down.
          this.framesHeld = {};

          KeyboardAdapter.init();
      },

      update() {
          // We could have some kind of "input adapter toggle", but it's easier to just treat all inputs
          // as valid -- if you're pressing the "attack" button on either gamepad or keyboard, then you're
          // attacking. For directional input, we instead check whether there's movement on the thumbstick,
          // and we use it if there is -- otherwise we try to extract movement from the keyboard instead.

          KeyboardAdapter.update();

          for (let action of Object.values(Input.Action)) {
              let held = KeyboardAdapter.held[action];
              this.pressed[action] = !this.held[action] && held;
              this.released[action] = this.held[action] && !held;

              if (this.pressed[action]) {
                  this.framesHeld[action] = 1;
              } else if (this.held[action] && held) {
                  this.framesHeld[action]++;
              }

              this.held[action] = held;
          }

          //this.pointer = pointerAdapter.pointer;
          this.direction = KeyboardAdapter.direction;
          //this.direction = this.gamepad.direction.m > 0 ? this.gamepad.direction : this.keyboard.direction;
      },

      onDown(action) {},
      onUp(action) {},
  };

  // Viewport


  /**
   * Viewport
   *
   * Represents the game display (for us, a canvas).
   */
  const Viewport = {
      init() {
          Viewport.canvas = document.getElementById('canvas');
          Viewport.ctx = Viewport.canvas.getContext('2d');
          Viewport.resize(true);
      },

      // Resize the canvas to give us approximately our desired game display size.
      //
      // Rather than attempt to explain it, here's a concrete example:
      //
      //     we start with a desired game dimension:   480x270px
      //          get the actual browser dimensions:  1309x468px
      //          factor in the display's DPR ratio:  2618x936px
      //         now calculate the horizontal scale:       5.45x
      //                     and the vertical scale:       3.46x
      //            our new offical game scaling is:        5.4x
      //       and our official viewport dimensions:   484x173px
      //
      // This approach emphasizes correct aspect ratio and maintains full-window rendering, at
      // the potential cost of limiting visibility of the game itself in either the X or Y axis.
      // If you use this approach, make sure your GUI can "float" (otherwise there may be whole
      // UI elements the player cannot see!).
      resize(force) {
          let dpr = window.devicePixelRatio,
              width = Viewport.canvas.clientWidth,
              height = Viewport.canvas.clientHeight,
              dprWidth = width * dpr,
              dprHeight = height * dpr;

          if (
              force ||
              Viewport.canvas.width !== dprWidth ||
              Viewport.canvas.height !== dprHeight
          ) {
              Viewport.canvas.width = dprWidth;
              Viewport.canvas.height = dprHeight;

              Viewport.scale = ((Math.min(dprWidth / TARGET_GAME_WIDTH, dprHeight / TARGET_GAME_HEIGHT) * 10) | 0) / 10;
              Viewport.width = Math.ceil(dprWidth / Viewport.scale);
              Viewport.height = Math.ceil(dprHeight / Viewport.scale);
              Viewport.center = {
                  u: (Viewport.width / 2) | 0,
                  v: (Viewport.height / 2) | 0
              };
              Viewport.clientWidth = width;
              Viewport.clientHeight = height;

              // Note: smoothing flag gets reset on every resize by some browsers, which is why
              // we do it here.
              Viewport.ctx.imageSmoothingEnabled = false;
          }

          // We do this every frame, not just on resize, due to browser sometimes "forgetting".
          Viewport.canvas.style.cursor = 'none';
      },

      fillViewportRect() {
          Viewport.ctx.fillRect(0, 0, Viewport.width, Viewport.height);
      },

      isOnScreen(uv) {
          return uv.u >= 0 && uv.v >= 0 && uv.u < Viewport.width && uv.v < Viewport.height;
      }
  };

  function normalizeVector(p) {
      let m = Math.sqrt(p.x * p.x + p.y * p.y);
      return m === 0 ? { x: 0, y: 0, m: 0 } : { x: p.x / m, y: p.y / m, m };
  }

  function vectorBetween(p1, p2) {
      return normalizeVector({ x: p2.x - p1.x, y: p2.y - p1.y });
  }

  function angle2vector(r, m) {
      return { x: Math.cos(r), y: Math.sin(r), m: m || 1 };
  }

  function vector2point(v) {
      return { x: v.x * (v.m || 1), y: v.y * (v.m || 1) };
  }

  function xy2qr(pos) {
      return { q: (pos.x / TILE_SIZE) | 0, r: (pos.y / TILE_SIZE) | 0 };
  }

  function qr2xy(pos) {
      return { x: pos.q * TILE_SIZE, y: pos.r * TILE_SIZE };
  }

  function clamp(value, min, max) {
      return value < min ? min : value > max ? max : value;
  }

  /**
   * @param {XY[]} bounds  the upper-left and lower-right bounds
   * @yields {QR}
   */
  function* tilesHitInBounds(bounds) {
      for (let r = bounds[0].y / TILE_SIZE | 0; r * TILE_SIZE < bounds[1].y; r++) {
          for (let q = bounds[0].x / TILE_SIZE | 0; q * TILE_SIZE <  bounds[1].x; q++) {
              yield { q, r };
          }
      }
  }

  function rgba(r, g, b, a) {
      return `rgba(${r},${g},${b},${a})`;
  }

  function createCanvas(width, height) {
      let canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      let ctx = canvas.getContext('2d');
      return { canvas, ctx };
  }

  function entityBB(entity) {
      return entity.bb.map(p => ({ x: p.x + entity.pos.x, y: p.y + entity.pos.y }));
  }

  function entityHBB(entity) {
      if (!entity.hbb) {
          return entityBB(entity);
      }
      return entity.hbb.map(p => ({ x: p.x + entity.pos.x, y: p.y + entity.pos.y }));
  }

  function entityABB(entity) {
      return entity.abb.map(p => ({ x: p.x + entity.pos.x, y: p.y + entity.pos.y }));
  }

  function isBoundingBoxOverlap(left, right) {
      return left[1].x >= right[0].x && right[1].x >= left[0].x &&
             left[1].y >= right[0].y && right[1].y >= left[0].y;
  }

  // Camera
  //
  // For now this is a very simple placeholder. Even if the camera never does
  // anything but follow the player, distinguishing between "where the player is"
  // and "what the map camera is looking at" is useful in other files.


  const Camera = {
      init() {
          this.pos = { x: 0, y: 0 };
          this.forceTarget = undefined;
          this.vel = { x: 0, y: 0 };
      },

      update() {
          if (this.forceTarget) {
              this.pos = this.forceTarget;

              /*
              let dist = vectorBetween(this.pos, this.forceTarget);

              if (dist.m < 1) {
                  this.forceTarget = undefined;
                  return;
              }

              dist.m = clamp(dist.m, 0, 2);

              let newVelocity = vector2point(dist);
              this.vel = {
                  x: (this.vel.x * 2 + newVelocity.x) / 3,
                  y: (this.vel.y * 2 + newVelocity.y) / 3
              };

              this.pos.x += this.vel.x;
              this.pos.y += this.vel.y;

              */
          }

          if (Input.pressed[Input.Action.RAW_TOUCH]) {
              this.dragStart = { ...this.pos };
          }

          if (Input.dragging) {
              this.pos = {
                  x: this.dragStart.x - Input.dragVector.x,
                  y: this.dragStart.y - Input.dragVector.y
              };
          }

          //this.pos = Game.player.pos;
          //this.pos = { x: 0, y: 0, z: 0 };
      }
  };

  // SpriteSheet

  /**
   * This module is generated by `gulp buildAssets`.
   */
  const SpriteSheet =
      /* <generated> */
  { bigarrow: [ [ 0, 0, 7, 13 ] ],
    bigpig:
     [ [ 0, 13, 15, 10 ],
       [ 15, 13, 15, 10 ],
       [ 30, 13, 15, 10 ],
       [ 45, 13, 15, 10 ],
       [ 60, 13, 15, 10 ],
       [ 75, 13, 15, 10 ] ],
    bleed:
     [ [ 0, 23, 9, 7 ],
       [ 9, 23, 9, 7 ],
       [ 18, 23, 9, 7 ],
       [ 27, 23, 9, 7 ],
       [ 36, 23, 9, 7 ],
       [ 45, 23, 9, 7 ],
       [ 54, 23, 9, 7 ],
       [ 63, 23, 9, 7 ] ],
    clouds: [ [ 0, 30, 28, 8 ], [ 28, 30, 28, 8 ], [ 56, 30, 28, 8 ], [ 84, 30, 28, 8 ] ],
    dirt: [ [ 0, 38, 1, 1 ], [ 1, 38, 1, 1 ] ],
    explosiona: [ [ 0, 39, 13, 13 ], [ 13, 39, 13, 13 ], [ 26, 39, 13, 13 ] ],
    explosionb:
     [ [ 0, 52, 21, 33 ],
       [ 21, 52, 21, 33 ],
       [ 42, 52, 21, 33 ],
       [ 63, 52, 21, 33 ],
       [ 84, 52, 21, 33 ] ],
    font4: [ [ 0, 85, 270, 12 ] ],
    hedgehog: [ [ 0, 97, 12, 8 ], [ 12, 97, 12, 8 ], [ 24, 97, 12, 8 ] ],
    knight: [ [ 0, 105, 7, 11 ], [ 7, 105, 7, 11 ], [ 14, 105, 7, 11 ] ],
    littlepig:
     [ [ 0, 116, 10, 7 ], [ 10, 116, 10, 7 ], [ 20, 116, 10, 7 ], [ 30, 116, 10, 7 ] ],
    littlepigbox:
     [ [ 0, 123, 15, 11 ], [ 15, 123, 15, 11 ], [ 30, 123, 15, 11 ], [ 45, 123, 15, 11 ] ],
    particle: [ [ 0, 134, 1, 1 ], [ 1, 134, 1, 1 ], [ 2, 134, 1, 1 ] ],
    sign: [ [ 0, 135, 10, 9 ] ],
    star2: [ [ 0, 144, 7, 6 ] ],
    tilebg: [ [ 0, 150, 10, 10 ], [ 10, 150, 10, 10 ], [ 20, 150, 10, 10 ] ],
    tiles:
     [ [ 0, 160, 8, 8 ],
       [ 8, 160, 8, 8 ],
       [ 16, 160, 8, 8 ],
       [ 24, 160, 8, 8 ],
       [ 32, 160, 8, 8 ],
       [ 40, 160, 8, 8 ],
       [ 48, 160, 8, 8 ],
       [ 56, 160, 8, 8 ],
       [ 64, 160, 8, 8 ],
       [ 72, 160, 8, 8 ] ],
    wip: [ [ 0, 168, 320, 180 ], [ 320, 168, 320, 180 ], [ 640, 168, 320, 180 ] ],
    base64:
     'data:image/png;base64,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' };
  /* </generated> */

  /**
   * Sprite
   *
   * Encapsulates loading sprite slices from the spritesheet, organizing them, and
   * modifying them or constructing using primitives. To save space, we use some techniques
   * like storing only a small slice of an image in the spritesheet, then using code
   * to duplicate it, add some randomness, etc.
   */
  const Sprite = {
      // This is an exception to the rule, loading the spritesheet is a special action that
      // happens BEFORE everything is initialized.
      loadSpritesheet(cb) {
          let image = new Image();
          image.onload = cb;
          image.src = SpriteSheet.base64;
          Sprite.sheet = image;
      },

      init() {
          Sprite.bigpig = [SpriteSheet.bigpig.map(initBasicSprite, { x: 7, y: 4 })];
          Sprite.bigpig.push(Sprite.bigpig[0].map(sprite => initDynamicSprite(flipHorizontal(sprite.img), sprite.anchor)));

          Sprite.littlepig = [SpriteSheet.littlepig.map(initBasicSprite)];
          Sprite.littlepig.push(Sprite.littlepig[0].map(sprite => initDynamicSprite(flipHorizontal(sprite.img), sprite.anchor)));

          Sprite.littlepigbox = SpriteSheet.littlepigbox.map(initBasicSprite, { x: 7, y: 5 });

          Sprite.wip = SpriteSheet.wip.map(initBasicSprite, { x: 0, y: 0 });

          Sprite.explosiona = SpriteSheet.explosiona.map(initBasicSprite);
          Sprite.explosionb = SpriteSheet.explosionb.map(initBasicSprite);

          Sprite.particle = SpriteSheet.particle.map(initBasicSprite);

          Sprite.star2 = SpriteSheet.star2.map(initBasicSprite);

          Sprite.bleed = SpriteSheet.bleed.map(initBasicSprite, { x: 4, y: 0 });

          Sprite.knight = [SpriteSheet.knight.map(initBasicSprite, { x: 3, y: 6 })];
          Sprite.knight.push(Sprite.knight[0].map(sprite => initDynamicSprite(flipHorizontal(sprite.img), sprite.anchor)));
          Sprite.hedgehog = [SpriteSheet.hedgehog.map(initBasicSprite, { x: 5, y: 4 })];
          Sprite.hedgehog .push(Sprite.hedgehog[0].map(sprite => initDynamicSprite(flipHorizontal(sprite.img), sprite.anchor)));

          Sprite.bigarrow = SpriteSheet.bigarrow.map(initBasicSprite);
          Sprite.dirt = SpriteSheet.dirt.map(initBasicSprite);

          Sprite.sign = SpriteSheet.sign.map(initBasicSprite);

          // Base pixel font and icons (see `Text.init` for additional variations)
          Sprite.font = initBasicSprite(SpriteSheet.font4[0]);
          //Sprite.icon_mouse_lmb = initBasicSprite(SpriteSheet.icon_mouse[0]);
          //Sprite.icon_mouse_rmb = initBasicSprite(SpriteSheet.icon_mouse[1]);

          Sprite.clouds = SpriteSheet.clouds.map(initBasicSprite);

          // Enemies

          // Tiles
          Sprite.tiles = SpriteSheet.tiles.map(initBasicSprite);
          Sprite.tilebg = SpriteSheet.tilebg.map(initBasicSprite);
      },

      /**
       * A small helper that draws a sprite onto a canvas, respecting the anchor point of
       * the sprite. Note that the canvas should be PRE-TRANSLATED and PRE-ROTATED, if
       * that's appropriate!
       */
      drawSprite(ctx, sprite, u, v) {
          ctx.drawImage(sprite.img, u - sprite.anchor.x, v - sprite.anchor.y);
      },

      drawViewportSprite(sprite, pos, rotation) {
          let { u, v } = this.viewportSprite2uv(
              sprite,
              pos
          );
          if (rotation) {
              Viewport.ctx.save();
              Viewport.ctx.translate(u + sprite.anchor.x, v + sprite.anchor.y);
              Viewport.ctx.rotate(rotation);
              Viewport.ctx.drawImage(
                  sprite.img,
                  -sprite.anchor.x,
                  -sprite.anchor.y
              );
              Viewport.ctx.restore();
          } else {
              Viewport.ctx.drawImage(sprite.img, u, v);
          }
      },

      drawSmashedSprite(sprite, pos, height) {
          let { u, v } = this.viewportSprite2uv(
              sprite,
              pos
          );

          Viewport.ctx.drawImage(sprite.img, u - 1, v - height + sprite.img.height, sprite.img.width + 2, height);
      },

      viewportSprite2uv(sprite, pos) {
          return {
              u: pos.x - sprite.anchor.x - Camera.pos.x + Viewport.center.u,
              v: pos.y - sprite.anchor.y - Camera.pos.y + Viewport.center.v
          };
      }
  };

  // Sprite utility functions

  function initBasicSprite(data, opts) {
      return initDynamicSprite(loadCacheSlice(...data), opts);
  }

  function initDynamicSprite(source, opts) {
      let w = source.width,
          h = source.height;

      if (typeof opts !== 'object') {
          opts = {};
      }

      if (!opts.anchor) {
          opts.anchor = { x: (w / 2) | 0, y: (h / 2) | 0 };
      }

      if (!opts.bb) {
          opts.bb = [-opts.anchor.x, -opts.anchor.y, source.width, source.height];
      }

      return {
          img: source,
          ...opts
      };
  }

  function loadCacheSlice(x, y, w, h) {
      const source = Sprite.sheet;
      const sliceCanvas = createCanvas(w, h);
      sliceCanvas.ctx.drawImage(source, x, y, w, h, 0, 0, w, h);
      return sliceCanvas.canvas;
  }

  function flipHorizontal(source) {
      let canvas = createCanvas(source.width, source.height);
      canvas.ctx.translate(source.width, 0);
      canvas.ctx.scale(-1, 1);
      canvas.ctx.drawImage(source, 0, 0);
      return canvas.canvas;
  }

  // Text


  const C_WIDTH = 5;
  const C_HEIGHT = 5;
  const FONT_SHEET_C_WIDTH = 6;
  const FONT_SHEET_WIDTH = 270;
  const DEFAULT_C_SHIFT = 5;

  // Very simple variable-width font implementation. The characters in the font strip
  // are left-aligned in their 5x5 pixel boxes, so in order to have variable width,
  // we just need to note the characters that AREN'T full width. Anything not in
  // this list has full shift (5+1 = 6 pixels).
  const C_SHIFT = {
      10: 0, // LF (\n)
      32: 3, // Space ( )
      33: 3, // Bang (!)
      39: 2, // Apostrophe (')
      44: 3, // Comma (,)
      46: 3, // Period (.)
      47: 6, // Slash (/)
      73: 2, // I
      77: 6, // M
      84: 6, // T
      86: 6, // V
      87: 6, // W
      88: 6, // X
      89: 6, // Y
      109: 6, // m (up)
      111: 6, // o (down)
  };

  const C_ICONS = {};

  const Text = {
      init() {
          Text.white = Sprite.font.img;
          Text.black = recolor(Text.white, rgba(0, 0, 0, 1));
          Text.shadow = recolor(Text.white, rgba(44, 27, 46, 1));
          Text.tan = recolor(Text.white, rgba(209, 180, 140, 1));
          Text.pig = recolor(Text.white, rgba(227, 66, 98, 1));
          Text.duotone = recolorDuotone(Text.white, '#f2b63d', '#fff4e0');
          Text.duotone_red = recolorDuotone(Text.white, '#ffaa5e', '#ffd4a3', rgba(255, 0, 0, 0.7));
      },

      drawText(ctx, text, u, v, scale = 1, font = Text.duotone, shadow) {
          for (let c of this.charactersToDraw(text, scale)) {
              if (C_ICONS[c.c]) {
                  ctx.drawImage(
                      C_ICONS[c.c].img,
                      u + c.u,
                      v + c.v - (C_ICONS[c.c].img.height + 4) / 2
                  );
              } else {
                  let k = (c.c - 32) * FONT_SHEET_C_WIDTH;
                  if (shadow) {
                      ctx.drawImage(
                          shadow,
                          k % FONT_SHEET_WIDTH,
                          (k / FONT_SHEET_WIDTH | 0) * FONT_SHEET_C_WIDTH,
                          C_WIDTH,
                          C_HEIGHT,
                          u + c.u,
                          v + c.v + 1,
                          C_WIDTH * scale,
                          C_HEIGHT * scale
                      );
                  }
                  ctx.drawImage(
                      font,
                      k % FONT_SHEET_WIDTH,
                      (k / FONT_SHEET_WIDTH | 0) * FONT_SHEET_C_WIDTH,
                      C_WIDTH,
                      C_HEIGHT,
                      u + c.u,
                      v + c.v,
                      C_WIDTH * scale,
                      C_HEIGHT * scale
                  );
              }
          }
      },

      measure(text, scale = 1) {
          let w = 0, h = 0;

          for (let c of this.charactersToDraw(text, scale)) {
              w = Math.max(w, c.u + (C_SHIFT[c.c] || DEFAULT_C_SHIFT) * scale);
              h = c.v + (C_HEIGHT + 2) * scale;
          }

          return { w, h };
      },

      *charactersToDraw(text, scale = 1) {
          let u = 0, v = 0;

          for (let idx = 0; idx < text.length; idx++) {
              let c = text.charCodeAt(idx);

              if (c === 10) {
                  u = 0;
                  v += (C_HEIGHT + 2) * scale;
                  continue;
              }

              yield { c, u, v };

              u += (C_SHIFT[c] || DEFAULT_C_SHIFT) * scale;
          }
      }
  };

  // Text utility functions


  function recolor(font, color) {
      let canvas = createCanvas(font.width, font.height);
      canvas.ctx.fillStyle = color;
      canvas.ctx.fillRect(0, 0, font.width, font.height);
      canvas.ctx.globalCompositeOperation = 'destination-in';
      canvas.ctx.drawImage(font, 0, 0);
      return canvas.canvas;
  }

  function recolorDuotone(font, topColor, bottomColor, tint) {
      // Note: shortcut assumes that the font image is exactly 2 rows of characters.
      let canvas = createCanvas(font.width, font.height);
      canvas.ctx.fillStyle = bottomColor;
      canvas.ctx.fillRect(0, 0, font.width, font.height);
      canvas.ctx.fillStyle = topColor;
      canvas.ctx.fillRect(0, 0, font.width, 1);
      canvas.ctx.fillRect(0, C_HEIGHT + 1, font.width, 1);
      if (tint) {
          canvas.ctx.fillStyle = tint;
          canvas.ctx.fillRect(0, 0, font.width, font.height);
      }
      canvas.ctx.globalCompositeOperation = 'destination-in';
      canvas.ctx.drawImage(font, 0, 0);
      return canvas.canvas;
  }

  // LoadingScene


  class LoadingScene {
      constructor() {
          this.text = [
              'HAROLD',
              'IS',
              'HEAVY'
          ];
          this.t = -12;
      }

      update() {
          this.t++;

          if (this.t === 36) ;

          if (this.t > 15) {
              game.scenes.pop();
          }
      }

      draw() {
          Viewport.ctx.fillStyle = '#2c1b2e';
          Viewport.ctx.fillRect(0, 0, Viewport.width, Viewport.height);

          Viewport.ctx.fillStyle = '#457cd6';
          Viewport.ctx.fillRect(Viewport.width / 2 - 65, Viewport.height / 2 - 8, 130, 16);
          Viewport.ctx.fillRect(Viewport.width / 2 - 64, Viewport.height / 2 - 9, 128, 18);

          let total = 10;
          let loaded = clamp(this.t / 6, 0, 10);

          for (let i = 0; i < total; i++) {
              let frame = (loaded > i) ? 0 : 3;
              let y = Math.sin(i * Math.PI * 2 / 9 + (this.t * Math.PI * 2 / 60)) * 3;
              Viewport.ctx.drawImage(Sprite.littlepig[0][frame].img, i * 12 + (Viewport.width - 120) / 2, Viewport.height / 2 - 3 + y);
          }

          this.drawInstructions();
      }

      drawInstructions() {
          let text = 'LOADING...';
          let width = Text.measure(text, 1).w;

          if (this.t % 30 < 24) {
              Text.drawText(Viewport.ctx, text, (Viewport.width - width) / 2, Viewport.height / 20 + 25, Text.duotone, Text.shadow);
          }
      }
  }

  // ScreenShake

  class ScreenShake {
      constructor(frames, hAmplitude, vAmplitude) {
          this.frames = frames;
          this.hAmplitude = hAmplitude;
          this.vAmplitude = vAmplitude;
          this.hSamples = [];
          this.vSamples = [];

          var sampleCount = frames / 2;
          for (let i = 0; i <= sampleCount; i++) {
              this.hSamples.push(Math.random() * 2 - 1);
              this.vSamples.push(Math.random() * 2 - 1);
          }
          this.frame = -1;
      }

      update() {
          this.frame++;
          if (this.frame >= this.frames) {
              this.x = 0;
              this.y = 0;
              return false;
          }

          // https://jonny.morrill.me/en/blog/gamedev-how-to-implement-a-camera-shake-effect/
          // let s = (this.frames / 10) * (this.frame / this.frames);
          let s = this.frame / 2;
          let s0 = s | 0;
          let s1 = s0 + 1;
          let decay = 1 - this.frame / this.frames;

          this.x =
              this.hAmplitude *
              decay *
              (this.hSamples[s0] +
                  (s - s0) * (this.hSamples[s1] - this.hSamples[s0]));
          this.y =
              this.vAmplitude *
              decay *
              (this.vSamples[s0] +
                  (s - s0) * (this.vSamples[s1] - this.vSamples[s0]));

          return true;
      }
  }

  // IntroScene


  class IntroScene {
      constructor() {
          this.text = [
              'HAROLD',
              'IS',
              'HEAVY'
          ];
          this.pos = [
              { y: -20 },
              { y: -20 },
              { y: -20 }
          ];
          this.vel = [
              { y: 0 },
              { y: 0 },
              { y: 0 }
          ];
          this.screenshakes = [];
          this.t = 0;
          this.fadet = -1;
      }

      update() {
          this.t++;

          if (this.t > 10) {
              game.scenes.pop();
              game.scenes.push(new LoadingScene());
          }

          /*
          this.vel[0].y = clamp(this.vel[0].y + GRAVITY, 0, TERMINAL_VELOCITY);
          if (this.pos[0].y > 15) {
              this.vel[1].y = clamp(this.vel[1].y + GRAVITY, 0, TERMINAL_VELOCITY);
          }
          if (this.pos[1].y > 15) {
              this.vel[2].y = clamp(this.vel[2].y + GRAVITY, 0, TERMINAL_VELOCITY);
          }

          if (this.pos[0].y < 45) {
              this.pos[0].y += this.vel[0].y;
          } else if (!this.screenshakes[0]) {
              this.screenshakes[0] = new ScreenShake(12, 0, 3);
          }
          if (this.pos[1].y < 60) {
              this.pos[1].y += this.vel[1].y;
          } else if (!this.screenshakes[1]) {
              this.screenshakes[1] = new ScreenShake(12, 0, 3);
          }
          if (this.pos[2].y < 75) {
              this.pos[2].y += this.vel[2].y;
          } else if (!this.screenshakes[2]) {
              this.screenshakes[2] = new ScreenShake(12, 0, 3);
          }
              */

          /*
          if (this.fadet >= 0) this.fadet++;

          if (this.fadet > 30) {
              game.screens.pop();
              game.screens.push(new LoadingScreen());
          }

          if (Input.pressed[Input.Action.JUMP] || Input.pressed[Input.Action.CONTINUE]) {
              this.fadet = 0;
          }

          for (let i = 0; i < 3; i++) {
              if (this.screenshakes[i]) {
                  this.screenshakes[i].update();
              }
          }*/
      }

      draw() {
          Viewport.ctx.fillStyle = '#457cd6';
          Viewport.ctx.fillRect(0, 0, Viewport.width, Viewport.height);

          let shakeX = 0, shakeY = 0;
          for (let i = 0; i < 3; i++) {
              if (this.screenshakes[i]) {
                  shakeX += this.screenshakes[i].x;
                  shakeY += this.screenshakes[i].y;
              }
          }
          Viewport.ctx.translate(shakeX, shakeY);

          for (let i = this.text.length - 1; i >= 0; i--) {
              let width = Text.measure(this.text[i], 2).w;

              //Viewport.ctx.globalAlpha = 0.3;
              //Text.drawText(Viewport.ctx, this.text[i], (Viewport.width - width) / 2, 50 + i * 15 - 4, 2, Text.pig);

              Viewport.ctx.globalAlpha = 1;
              Text.drawText(Viewport.ctx, this.text[i], (Viewport.width - width) / 2, this.pos[i].y - 1, 2, Text.shadow);
              Text.drawText(Viewport.ctx, this.text[i], (Viewport.width - width) / 2, this.pos[i].y + 1, 2, Text.shadow);
              Text.drawText(Viewport.ctx, this.text[i], (Viewport.width - width) / 2 - 1, this.pos[i].y, 2, Text.shadow);
              Text.drawText(Viewport.ctx, this.text[i], (Viewport.width - width) / 2 + 1, this.pos[i].y, 2, Text.shadow);
              Text.drawText(Viewport.ctx, this.text[i], (Viewport.width - width) / 2, this.pos[i].y, 2, Text.pig);
          }

          if (this.pos[2].y > 50) {
              this.drawInstructions();
          }

          // Fade to load screen
          if (this.fadet >= 0) {
              let fade = 0;
              if (this.fadet > 8) {
                  fade = (this.fadet - 8) * (Viewport.width / 2 - 40) / 20;
              }

              Viewport.ctx.fillStyle = '#2c1b2e';
              Viewport.ctx.beginPath();
              Viewport.ctx.moveTo(Viewport.width / 2 - 0 - fade, 0);
              Viewport.ctx.lineTo(Viewport.width / 2 + 40 + fade, 0);
              Viewport.ctx.lineTo(Viewport.width / 2 + 0 + fade, Viewport.height);
              Viewport.ctx.lineTo(Viewport.width / 2 - 40 - fade, Viewport.height);
              Viewport.ctx.closePath();
              Viewport.ctx.fill();
          }
      }

      drawInstructions() {
          let text = 'PRESS SPACE OR ENTER TO START';
          let width = Text.measure(text, 1).w;

          if (this.t % 30 < 24) {
              Text.drawText(Viewport.ctx, text, (Viewport.width - width) / 2, Viewport.height - 10, 1, Text.white, Text.shadow);
          }
      }
  }

  // BigArrowParticle


  class BigArrowParticle {
      constructor(pos) {
          this.frame = 0;
          this.pos = { ...pos };
          this.t = 0;
          this.d = 15;
          this.z = 5;

          // TEMPORARY
          this.noClipEntity = true;
          this.noClipWall = true;
      }

      update() {
          if (++this.t === this.d) this.cull = true;
          this.pos.y += 1;
      }

      draw() {
          Viewport.ctx.globalAlpha = 0.6;
          Sprite.drawViewportSprite(Sprite.bigarrow[this.frame], this.pos);
          Viewport.ctx.globalAlpha = 1;
      }
  }

  // CloudParticle
  //
  // Cloud particles slowly move across the top of the screen. They are drawn
  // a bit different because their coordinate system is the screen, not the map.


  class CloudParticle {
      constructor(middle) {
          let velDice = Math.floor(Math.random() * 3);
          let velX = [0.1, 0.2, 0.3];

          this.frame = Math.floor(Math.random() * 4);
          this.pos = {
              x: middle ? Viewport.width / 2 + Math.random() * 40 : Viewport.width + 1,
              y: Math.floor(Math.random() * 30 + 2)
          };
          this.vel = {
              x: 0 - velX[velDice],
              y: 0
          };
          this.z = -1;

          // TEMPORARY
          this.noClipWall = true;
          this.noClipEntity = true;
      }

      update() {
          if (this.pos.x < -30) this.cull = true;
      }

      draw() {
          // Our "x,y" is ACTUALLY a "u,v", which is a bit confusing... clouds don't move with
          // the tileset in this game.
          Viewport.ctx.drawImage(Sprite.clouds[this.frame].img, this.pos.x, this.pos.y);
      }
  }

  // FallingDirtParticle
  //
  // A falling dirt particle is spawned only beneath tiles that are super-slammable
  // (can be pushed down by the player), whenever the player lands.


  class FallingDirtParticle {
      constructor(pos) {
          this.frame = Math.floor(Math.random() * 2);
          this.pos = { ...pos };
          this.t = 0;
          this.d = 15;
          this.z = 4;

          // TEMPORARY
          this.noClipEntity = true;
          this.noClipWall = true;
      }

      update() {
          if (++this.t === this.d) this.cull = true;
          this.pos.y += 0.5;
      }

      draw() {
          Viewport.ctx.globalAlpha = 1;
          Sprite.drawViewportSprite(Sprite.dirt[this.frame], this.pos);
      }
  }

  // LandingParticle


  class LandingParticle {
      constructor(pos) {
          this.pos = { ...pos };
          this.angle = (Math.random() * Math.PI * 0.8) + Math.PI * 1.1;
          this.vel = vector2point(angle2vector(this.angle, 1.5));
          this.pos.x += this.vel.x * 3;
          this.pos.y += 5;
          this.vel.x /= 10;
          this.z = 12;

          this.radius = 1;
          this.r = 0;
          this.t = -1;
          this.d = 12;

          // TEMPORARY
          this.noClipWall = true;
          this.noClipEntity = true;
      }

      update() {
          if (++this.t === this.d) this.cull = true;
          this.vel.x *= 0.99;
          this.vel.y = clamp(this.vel.y + GRAVITY / 2, -TERMINAL_VELOCITY, TERMINAL_VELOCITY);
          //this.a *= 0.99;
          //this.r += this.a;
      }

      draw() {
          Sprite.drawViewportSprite(Sprite.particle[0], this.pos, this.r);
      }
  }

  // StarParticle
  //
  // Star particles are spawned when player spawns in level and around
  // friends when rescued from crates.


  class StarParticle {
      constructor(pos, extra) {
          this.frame = 0;
          this.pos = { ...pos };
          this.angle = Math.random() * Math.PI * 2;
          this.vel = vector2point(angle2vector(this.angle, 2.7));
          this.a = 10 * Math.PI / 180;
          this.noClipEntity = true;
          this.radius = 1;
          this.r = Math.random() * Math.PI * 2;
          this.t = -1 - (extra || 0);
          this.d = 12;
          this.z = 1;

          // TEMPORARY
          this.noClipWall = true;
      }

      update() {
          if (++this.t === this.d) this.cull = true;
          this.vel.x *= 0.9;
          this.vel.y *= 0.9;
          //this.vel.x *= 0.9;
          //this.vel.y = clamp(this.vel.y + 0.11, -10, 2);
          this.a *= 0.99;
          this.r += this.a;
      }

      draw() {
          Sprite.drawViewportSprite(Sprite.star2[this.frame], this.pos, this.r);
      }
  }

  // ExplosionBParticle
  //
  // "Explosion B" is a short pink/white explosion used when the player
  // dies (i.e. falls off the screen or touches an enemy).


  class ExplosionBParticle {
      constructor(pos) {
          this.frame = 0;
          this.pos = { ...pos };
          this.noClipEntity = true;
          this.t = -1;
          this.d = 30;

          // TEMPORARY
          this.noClipWall = true;
      }

      update() {
          if (++this.t === this.d) this.cull = true;
          if (this.t === 6) this.frame++;
          if (this.t === 12) this.frame++;
          if (this.t === 18) this.frame++;
          if (this.t === 24) this.frame++;
      }

      draw() {
          Sprite.drawViewportSprite(Sprite.explosionb[this.frame], this.pos, this.r);
      }
  }

  // Player


  const PLAYING = 1;
  const DYING = 2;

  class Player {
      constructor(pos) {
          this.pos = { ...pos };
          this.vel = { x: 0, y: 0 };
          this.frame = 0;
          this.radius = 4;
          this.jumpLength = 0;
          this.jumpFrames = 0;
          this.facing = 0;
          this.isJumping = true;
          this.lastJumpPressed = 0;
          this.team = 1;
          this.z = 10;
          this.highestY = this.pos.y;
          this.state = PLAYING;
          this.last = [this.pos, this.pos];
          this.dead = false;

          this.bb = [{ x: -4, y: -4 }, { x: 4, y: 5 }];
          this.hbb = [{ x: -4, y: -4 }, { x: 4, y: 5 }];
          this.abb = [{ x: -6, y: 4 }, { x: 6, y: 5 }];

          // temp
          this.noClipWall = true;
          this.newClip = true;
      }

      update() {
          let input = Input;

          // The player character has two modes -- if we're RECORDING (default), then we take
          // the current Input set and record this frame. If we're REPLAYING (victory screen),
          // we grab the next input frame from the recording and use that as our input.
          if (this.recording) {
              this.recording.record();
          } else if (this.replay) {
              this.replay.replay();
              input = this.replay;
          }

          this.last[1] = { ...this.last[0] };
          this.last[0] = { ...this.pos };

          if (this.state === DYING) {
              this.stateFrames++;
              if (this.stateFrames > 30) {
                  game.restartLevel();
              }
              return;
          }

          if (this.pos.y < this.highestY) {
              this.highestY = this.pos.y;
          }

          let v = {
              x: input.direction.x * input.direction.m * PLAYER_FOOT_SPEED,
              y: input.direction.y * input.direction.m * 0.4
          };

          this.vel.x = clamp((this.vel.x + v.x) / 2, -PLAYER_FOOT_SPEED, PLAYER_FOOT_SPEED);
          //this.vel.y = (this.vel.y + v.y) / 2;

          // move
          ///this.pos.x += this.vel.x;
          ///this.pos.y += this.vel.y;

          if (input.pressed[Input.Action.JUMP]) {
              this.lastJumpPressed = game.frame;
          }

          if (!this.isJumping && game.frame - this.lastJumpPressed <= JUMP_CHEAT_LANDING_FRAMES) {
              this.isJumping = true;
              this.lastJumpPressed = 0;
              //this.jumpFrames = 16;
              //this.jumpLength = 0;
              this.vel.y = JUMP_VELOCITY - GRAVITY;
              Audio.play(Audio.playerJump);
          }

          /*if (this.jumpFrames > 0) {
              this.jumpFrames--;
              this.jumpLength++;
              this.vel.y = -1.2;
          }

          if (Input.held[Input.Action.JUMP] && this.jumpFrames < 1 && this.jumpLength < 36) {
              this.jumpFrames = 1;
          }*/

          if (this.vel.y < 0) {
              this.frame = 3;
          } else if (this.vel.y > 0) {
              // If you start falling, you can't jump anymore
              this.isJumping = true;

              this.frame = 4;
              if (this.pos.y - this.highestY > 12) {
                  this.frame = 5;
              }
              /*if (this.pos.y - this.highestY > 32) {
                  this.frame = 6;
              }*/
          } else if (Math.abs(this.vel.x) < 0.1) {
              this.frame = 0;
          } else {
              this.frame = (Math.floor(this.pos.x / 8) % 2) + 1;
          }

          this.vel.y += GRAVITY;
          //this.vel.y += 0.12;

          if (this.vel.y > TERMINAL_VELOCITY) this.vel.y = TERMINAL_VELOCITY;

          if (this.vel.x > 0) this.facing = 0;
          if (this.vel.x < 0) this.facing = 1;
      }

      landedOnTile(tile) {
          if (this.dead) return;

          let distanceFallen = this.pos.y - this.highestY;
          this.highestY = this.pos.y;

          if (this.isJumping) {
              this.isJumping = false;
          }

          if (distanceFallen > 4) {
              game.levelScreen.landedOnTile(tile, distanceFallen > SUPER_SLAM_FALL_DISTANCE);
              game.levelScreen.screenshakes.push(new ScreenShake(12, 0, 3));
              game.levelScreen.addTileShake(new ScreenShake(15, 0, 9), tile);

              //game.levelScreen.addEntity(new StarParticle(this.pos));
              for (let entity of game.levelScreen.entities) {
                  if (entity.team && entity.team !== this.team && Math.abs(entity.pos.x - this.pos.x) < SLAM_ENEMY_DISTANCE && Math.abs(entity.pos.y - this.pos.y) < 4) {
                      entity.landedNearby(this);
                  }
              }

              if (distanceFallen > SUPER_SLAM_FALL_DISTANCE) {
                  Audio.play(Audio.playerSlam);
              }
          }
      }

      draw() {
          if (this.state !== DYING) {
              let qr = xy2qr(this.pos);
              let shakemap = game.levelScreen.tileshakemap[qr.r + 1]?.[qr.q];
              let y = shakemap && shakemap.y ? shakemap.y : 0;

              if (this.pos.y - this.highestY > SUPER_SLAM_FALL_DISTANCE) {
                  Viewport.ctx.globalAlpha = 0.2;
                  Sprite.drawViewportSprite(Sprite.bigpig[this.facing][this.frame], { x: this.last[1].x, y: this.pos.y + y - 4 });
              }
              if (this.pos.y - this.highestY > SUPER_SLAM_FALL_DISTANCE) {
                  Viewport.ctx.globalAlpha = 0.4;
                  Sprite.drawViewportSprite(Sprite.bigpig[this.facing][this.frame], { x: this.last[0].x, y: this.pos.y + y - 2 });
              }
              Viewport.ctx.globalAlpha = 1;
              Sprite.drawViewportSprite(Sprite.bigpig[this.facing][this.frame], { x: this.pos.x, y: this.pos.y + y });
          }
      }

      attack(victim) {
          victim.crushedBy(this);
      }

      dieFalling(levelBottomY) {
          if (this.state !== DYING) {
              this.state = DYING;
              this.dead = true;
              this.vel.x = 0;
              this.stateFrames = 0;
              game.levelScreen.addEntity(new ExplosionBParticle({ x: this.pos.x, y: levelBottomY - 2 }));
              Audio.play(Audio.playerDeath);
          }
      }

      dieHit(enemy) {
          if (this.state !== DYING) {
              this.state = DYING;
              this.dead = true;
              this.vel.x = 0;
              this.stateFrames = 0;
              game.levelScreen.addEntity(new ExplosionBParticle({ x: this.pos.x, y: this.pos.y }));
              Audio.play(Audio.playerDeath);
          }
      }
  }

  class Replay {
      constructor(levelNumber) {
          this.levelNumber = levelNumber;
          this.frames = [];
          this.replayIndex = 0;
      }

      record() {
          if (this.frames.length < 3000) {
              this.frames.push({
                  direction: { ...Input.direction },
                  pressed: {...Input.pressed }
              });
          }
      }

      reset() {
          this.replayIndex = 0;
      }

      replay() {
          if (this.replayIndex < this.frames.length) {
              this.direction = this.frames[this.replayIndex].direction;
              this.pressed = this.frames[this.replayIndex].pressed;
              this.replayIndex++;
          } else {
              this.direction = { x: 0, y: 0, m: 1 };
              this.pressed = {};
          }
      }

      done() {
          return this.replayIndex >= this.frames.length;
      }
  }

  // LevelData
  //
  // This file is generated by `gulp buildAssets`.

  const LevelData =
  /* <generated-data> */
  [
      {
          "floors": [
              {
                  "name": "FLOOR1",
                  "tiles": [
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          0,
                          1,
                          1,
                          1,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          2,
                          2,
                          2,
                          1,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          8,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          9,
                          9,
                          9,
                          9,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          8
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          7,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          9,
                          0,
                          0,
                          0,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          3,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          3,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          3,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          3,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4,
                          3,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          3,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4,
                          3,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4,
                          3,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ]
                  ],
                  "objects": [
                      {
                          "name": "SPAWN",
                          "x": 2,
                          "y": 6
                      },
                      {
                          "name": "SIGN01",
                          "x": 2,
                          "y": 11
                      },
                      {
                          "name": "SIGN02",
                          "x": 11,
                          "y": 11
                      },
                      {
                          "name": "BOX",
                          "x": 51,
                          "y": -1
                      },
                      {
                          "name": "SIGN04",
                          "x": 44,
                          "y": 3
                      },
                      {
                          "name": "BOX",
                          "x": 67,
                          "y": 7
                      },
                      {
                          "name": "SIGN05",
                          "x": 55,
                          "y": -1
                      }
                  ],
                  "areas": [],
                  "id": 0
              }
          ],
          "bounds": [
              [
                  0,
                  0
              ],
              [
                  69,
                  24
              ]
          ],
          "spawn": [
              2,
              6,
              0
          ]
      },
      {
          "floors": [
              {
                  "name": "FLOOR1",
                  "tiles": [
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          0,
                          5,
                          0,
                          5
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          5
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          5
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          1,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          8,
                          0,
                          2,
                          2,
                          0,
                          0,
                          9,
                          9,
                          9,
                          0,
                          0,
                          0,
                          9,
                          9,
                          9,
                          0,
                          0,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          2,
                          2
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          8,
                          0,
                          2,
                          2,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          8,
                          0,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          0,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4
                      ],
                      [
                          7,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          8,
                          0,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          2,
                          4,
                          4,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          3,
                          3,
                          3,
                          3,
                          3,
                          3,
                          3,
                          3,
                          3,
                          4,
                          4,
                          4,
                          4,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          3,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          3,
                          3,
                          3,
                          4,
                          4,
                          4,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          3,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          3,
                          3,
                          3,
                          3,
                          3,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          3,
                          3,
                          3,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          3,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ],
                      [
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          4
                      ]
                  ],
                  "objects": [
                      {
                          "name": "SPAWN",
                          "x": 4,
                          "y": 2
                      },
                      {
                          "name": "BOX",
                          "x": 47,
                          "y": 9
                      },
                      {
                          "name": "KNIGHT",
                          "x": 15,
                          "y": 13
                      },
                      {
                          "name": "KNIGHT",
                          "x": 22,
                          "y": 12
                      },
                      {
                          "name": "KNIGHT",
                          "x": 45,
                          "y": 6
                      },
                      {
                          "name": "KNIGHT",
                          "x": 49,
                          "y": 6
                      },
                      {
                          "name": "BOX",
                          "x": 69,
                          "y": 10
                      },
                      {
                          "name": "BOX",
                          "x": 58,
                          "y": 10
                      },
                      {
                          "name": "SIGN06",
                          "x": 26,
                          "y": 9
                      },
                      {
                          "name": "BOX",
                          "x": 81,
                          "y": 5
                      },
                      {
                          "name": "KNIGHT",
                          "x": 79,
                          "y": -1
                      },
                      {
                          "name": "KNIGHT",
                          "x": 83,
                          "y": -1
                      }
                  ],
                  "areas": [],
                  "id": 0
              }
          ],
          "bounds": [
              [
                  0,
                  0
              ],
              [
                  84,
                  22
              ]
          ],
          "spawn": [
              4,
              2,
              0
          ]
      },
      {
          "floors": [
              {
                  "name": "FLOOR1",
                  "tiles": [
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          0,
                          5,
                          0,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          0,
                          0,
                          0,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          5,
                          0,
                          5,
                          0,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          0,
                          5,
                          0,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          5,
                          0,
                          0,
                          5,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          6,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          6,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          6,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          6,
                          0,
                          0,
                          9,
                          9,
                          9,
                          9,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          2,
                          9,
                          9,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          3,
                          3,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          2,
                          2,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          3,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          2,
                          2,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          9,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          2,
                          2,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          1,
                          1,
                          1,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          2,
                          2,
                          1,
                          8,
                          0,
                          0,
                          7,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          0,
                          0,
                          0,
                          4,
                          4,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          3,
                          3,
                          3,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ]
                  ],
                  "objects": [
                      {
                          "name": "SPAWN",
                          "x": 11,
                          "y": 8
                      },
                      {
                          "name": "BOX",
                          "x": 61,
                          "y": 20
                      },
                      {
                          "name": "SLAM",
                          "x": 39,
                          "y": 24
                      },
                      {
                          "name": "SIGN07",
                          "x": 39,
                          "y": 14
                      },
                      {
                          "name": "HEDGEHOG",
                          "x": 17,
                          "y": 12
                      },
                      {
                          "name": "BOX",
                          "x": 11,
                          "y": 4
                      },
                      {
                          "name": "BOX",
                          "x": 45,
                          "y": 17
                      },
                      {
                          "name": "SIGN08",
                          "x": 25,
                          "y": 19
                      },
                      {
                          "name": "HEDGEHOG",
                          "x": 9,
                          "y": 23
                      },
                      {
                          "name": "BOX",
                          "x": 8,
                          "y": 23
                      }
                  ],
                  "areas": [],
                  "id": 0
              }
          ],
          "bounds": [
              [
                  0,
                  0
              ],
              [
                  65,
                  33
              ]
          ],
          "spawn": [
              11,
              8,
              0
          ]
      },
      {
          "floors": [
              {
                  "name": "FLOOR1",
                  "tiles": [
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          0,
                          5,
                          0,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          6,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          6,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          6,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          6,
                          6,
                          6,
                          5,
                          5
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          0,
                          0,
                          5,
                          0,
                          0,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0,
                          5,
                          0,
                          5,
                          0,
                          5,
                          0,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          6,
                          5,
                          5,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          5,
                          6,
                          5,
                          6,
                          5,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          7,
                          1,
                          1,
                          1,
                          1,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          2,
                          2,
                          2,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          4,
                          4,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          3,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          6,
                          5,
                          6,
                          6,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          6,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          6,
                          6,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          5,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          9,
                          9,
                          9,
                          9,
                          9,
                          9,
                          0,
                          0,
                          0,
                          9,
                          9,
                          9,
                          9,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          9,
                          9,
                          9,
                          9,
                          9,
                          9,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          9,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          7,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          7,
                          1,
                          1,
                          8,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          9,
                          0,
                          2,
                          2,
                          2,
                          2,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ],
                      [
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          4,
                          4,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0,
                          0
                      ]
                  ],
                  "objects": [
                      {
                          "name": "SPAWN",
                          "x": 1,
                          "y": 15
                      },
                      {
                          "name": "KNIGHT",
                          "x": 8,
                          "y": 21
                      },
                      {
                          "name": "KNIGHT",
                          "x": 17,
                          "y": 24
                      },
                      {
                          "name": "KNIGHT",
                          "x": 16,
                          "y": 27
                      },
                      {
                          "name": "BOX",
                          "x": 13,
                          "y": 31
                      },
                      {
                          "name": "BOX",
                          "x": 6,
                          "y": 16
                      },
                      {
                          "name": "BOX",
                          "x": 26,
                          "y": 27
                      },
                      {
                          "name": "KNIGHT",
                          "x": 28,
                          "y": 25
                      },
                      {
                          "name": "KNIGHT",
                          "x": 13,
                          "y": 24
                      },
                      {
                          "name": "SLAM",
                          "x": 13,
                          "y": 16
                      },
                      {
                          "name": "HEDGEHOG",
                          "x": 19,
                          "y": 21
                      }
                  ],
                  "areas": [],
                  "id": 0
              }
          ],
          "bounds": [
              [
                  0,
                  0
              ],
              [
                  33,
                  38
              ]
          ],
          "spawn": [
              1,
              15,
              0
          ]
      }
  ]
  /* </generated-data> */
  ;

  const Attack = {
      perform(level, entities) {
          let relevantEntities = entities.filter(entity => entity.team);

          relevantEntities.sort((a, b) => a.team - b.team);

          for (let attacker of relevantEntities) {
              if (attacker.abb) {
                  for (let victim of relevantEntities) {
                      if (attacker.team === victim.team || victim.immune || attacker.dead) continue;

                      if (victim.bb) {
                          if (isBoundingBoxOverlap(entityABB(attacker), entityHBB(victim))) {
                              attacker.attack(victim);
                          }
                      }
                  }
              }
          }
      }
  };

  // Movement


  const Movement = {
      perform(level, entities) {
          // Movement only applies to active entities with positions and velocities
          let movers = entities.filter(
              entity => entity.pos && entity.vel && !entity.cull
          );

          // Very basic "rounds" of collision resolution, since we have no real physics.
          // (As usual, "detecting" a collision is not the hard part... we need to resolve
          // them too!)
          for (let rounds = 0; rounds < 5; rounds++) {
              for (let entity of movers) {
                  Movement.clipVelocityAgainstTiles2(level, entity);
              }
          }

          // Now we perform all movement, even if it's not going to be perfect.
          for (let entity of movers) {
              entity.pos.x += entity.vel.x;
              entity.pos.y += entity.vel.y;
          }
      },

      clipVelocityAgainstTiles2(level, entity) {
          if (!entity.newClip) return;

          let xArray = [
              entity.pos.x + entity.bb[0].x,
              entity.pos.x + entity.bb[1].x
          ];

          let yArray = [
              entity.pos.y + entity.bb[0].y,
              entity.pos.y + entity.bb[1].y
          ];

          if (entity.vel.x <= 0) {
              xArray[0] += entity.vel.x;
          } else {
              xArray[1] += entity.vel.x;
          }

          if (entity.vel.y <= 0) {
              yArray[0] += entity.vel.y;
          } else {
              yArray[1] += entity.vel.y;
          }

          let bounds = [
              { x: xArray[0], y: yArray[0] },
              { x: xArray[1], y: yArray[1] }
          ];

          for (let tile of tilesHitInBounds(bounds)) {
              if (!level.tileIsPassable(tile.q, tile.r)) {
                  let tileXY = qr2xy(tile);

                  // This algorithm is kind of a practical approach to the question of
                  // how to interact with tiles hit while moving. Instead of computing the
                  // the normal of our velocity into the sides of a tile hit, we compute
                  // what we WOULD do if we chose to bounce off the X side or Y side of
                  // a tile, and then we pick whichever one will move the player the least.
                  //
                  // This generally gives behavior that feels "expected" - jumping into the side
                  // of a block results in stopping and sliding down, while jumping into the
                  // bottom of a block results in hitting your head.

                  let suggested = [];

                  if (tileXY.y + JUMP_CHEAT_Y_PIXELS >= entity.pos.y + entity.bb[1].y) {
                      let lowestAllowedY = tileXY.y - entity.bb[1].y;
                      suggested.push({
                          pos: { x: entity.pos.x, y: lowestAllowedY },
                          vel: { x: entity.vel.x, y: 0 },
                          tile: tile
                      });
                  }
                  if (tileXY.x >= entity.pos.x + entity.bb[1].x) {
                      let rightmostAllowedX = tileXY.x - entity.bb[1].x;
                      suggested.push({
                          pos: { x: rightmostAllowedX, y: entity.pos.y },
                          vel: { x: 0, y: entity.vel.y }
                      });
                  }
                  if (tileXY.x <= entity.pos.x - entity.bb[1].x) {
                      let leftmostAllowedX = tileXY.x + TILE_SIZE - entity.bb[0].x;
                      suggested.push({
                          pos: { x: leftmostAllowedX, y: entity.pos.y },
                          vel: { x: 0, y: entity.vel.y }
                      });
                  }
                  if (tileXY.y < entity.pos.y) {
                      let highestAllowedY = tileXY.y + TILE_SIZE - entity.bb[0].y;
                      suggested.push({
                          pos: { x: entity.pos.x, y: highestAllowedY },
                          vel: { x: entity.vel.x, y: 0 }
                      });
                  }

                  let chosen = suggested[0];
                  let pixelDistance = vectorBetween(entity.pos, chosen.pos).m;
                  for (let i = 1; i < suggested.length; i++) {
                      let newPixelDistance = vectorBetween(entity.pos, suggested[i].pos).m;
                      if (newPixelDistance < pixelDistance) {
                          pixelDistance = newPixelDistance;
                          chosen = suggested[i];
                      }
                  }

                  entity.pos = chosen.pos;
                  entity.vel = chosen.vel;
                  if (chosen.tile && entity.landedOnTile) entity.landedOnTile(tile);
              }
          }
      }
  };

  // GameScene


  class GameScene {
      constructor(levelNumber, replay) {
          game.levelScreen = this;

          this.levelNumber = levelNumber;
          this.levelData = LevelData[this.levelNumber];
          //this.tiles = this.levelData.floors[0].tiles.map(row => [...row]);
          //this.tileshakemap = this.levelData.floors[0].tiles.map(row => row.map(x => ({ x: 0, y: 0 })));
          this.entities = [];
          this.screenshakes = [];
          this.tileshakes = [];
          this.superslamTiles = [];
          this.t = 0;
          this.lastCloud = 0;
          this.lightUpSlamTiles = 0;

          //this.player = new Player(qr2xy({ q: this.levelData.spawn[0], r: this.levelData.spawn[1] }));
          this.player = new Player(qr2xy({ q: 0, r: 0 }));

          if (replay) {
              replay.reset();
              this.player.replay = replay;
          } else {
              this.replay = new Replay(levelNumber);
              this.player.recording = this.replay;
          }

          this.addEntity(this.player);
          this.addEntity(new StarParticle(this.player.pos));
          this.addEntity(new StarParticle(this.player.pos));
          this.addEntity(new StarParticle(this.player.pos));
          this.addEntity(new StarParticle(this.player.pos));
          this.addEntity(new CloudParticle(true));

          this.littlePigs = 0;
          this.littlePigsRescued = 0;

          this.enemiesAlive = 0;

          //for (const obj of this.levelData.floors[0].objects) {
          for (const obj of []) {
              continue;
          }

          Camera.pos = { ...this.player.pos };
      }

      update() {
          this.t++;

          if (this.t === 4) {
              Audio.play(Audio.levelStart);
          }

          //let levelBottomY = qr2xy({ q: 0, r: this.tiles.length - 1 }).y;
          let levelBottomY = 100;
          let cameraMaxY = levelBottomY - (TARGET_GAME_HEIGHT / 2);

          /*Camera.forceTarget = {
              x: this.player.pos.x,
              y: Math.min(this.player.pos.y, cameraMaxY)
          };*/
          //Camera.update();

          Camera.pos.x = (Camera.pos.x * 0.92 + this.player.pos.x * 0.08);
          Camera.pos.y = Math.min((Camera.pos.y * 0.92 + this.player.pos.y * 0.08), cameraMaxY);

          if (this.player.pos.y > levelBottomY) {
              this.player.dieFalling(levelBottomY);
          }

          let entities = [...this.entities];

          for (const entity of entities) {
              entity.update();
          }

          Movement.perform(this, entities);
          Attack.perform(this, entities);

          for (let i = 0; i < this.entities.length; i++) {
              if (this.entities[i].cull) {
                  this.entities.splice(i, 1);
                  i--;
              }
          }

          // Tick screenshakes and cull finished screenshakes
          for (let i = 0; i < this.screenshakes.length; i++) {
              if (!this.screenshakes[i].update()) {
                  this.screenshakes.splice(i, 1);
                  i--;
              }
          }

          // Tick tileshakes and cull finished tileshakes
          for (let i = 0; i < this.tileshakes.length; i++) {
              if ((this.tileshakes[i].s++ > 15)) {
                  this.tileshakes.splice(i, 1);
                  i--;
              }
          }

          if (this.fallingDirtCounter > 0) {
              this.fallingDirtCounter--;
              this.spawnFallingDirt();
          }

          if (this.lightUpSlamTiles > 0) {
              this.lightUpSlamTiles--;
          }

          this.spawnClouds();
      }

      draw() {
          Viewport.ctx.fillStyle = '#457cd6';
          Viewport.ctx.fillRect(0, 0, Viewport.width, Viewport.height);

          Viewport.ctx.drawImage(Sprite.wip[2].img, 0, 0);
          //Sprite.drawViewportSprite(Sprite.viewportSprite2uv, { x: 0, y: 0 });
          Text.drawText(Viewport.ctx, 'HELLO hello', 50, 10, 1, Text.white);

          return;
      }

      drawTiles() {
          return;
      }

      drawTileShakemap() {
          for (let r = 0; r < this.tileshakemap.length; r++) {
              for (let q = 0; q < this.tileshakemap[0].length; q++) {
                  this.tileshakemap[r][q].x = 0;
                  this.tileshakemap[r][q].y = 0;
              }
          }

          for (let i = 0; i < this.tileshakes.length; i++) {
              let tileshake = this.tileshakes[i];
              for (let tile of tileshake.tiles) {
                  //this.tileshakemap[tile.r][tile.q].x += tileshake.screenshake.x;
                  let k = 0;
                  if (tileshake.s < 9) k++;
                  if (tileshake.s < 6) k++;
                  if (tileshake.s < 4) k++;
                  if (tileshake.s < 2) k++;
                  this.tileshakemap[tile.r][tile.q].y += k;
              }
          }
      }

      tileIsPassable(q, r) {
          return true;
      }

      entityIsOnSolidGround(entity) {
          let qr = xy2qr({ x: entity.pos.x, y: entity.pos.y + entity.bb[1].y });

          return !this.tileIsPassable(qr.q, qr.r);
      }

      landedOnTile(tile, superslamFlag) {
          if (superslamFlag) {
              for (let i = 0; i < this.superslamTiles.length; i++) {
                  let slam = this.superslamTiles[i];
                  if (tile.r === slam.r && tile.q >= slam.q1 && tile.q <= slam.q2) {
                      for (let q = slam.q1; q <= slam.q2; q++) {
                          this.tiles[slam.r + 1][q] = this.tiles[slam.r][q];
                          this.tiles[slam.r][q] = this.tiles[slam.r + 1][q] === 5 ? 6 : 0;

                          let xy = this.player.pos;
                          this.addEntity(new BigArrowParticle({ x: xy.x, y: xy.y }));
                      }
                  }
              }
          }

          for (let entity of this.entities) {
              if (entity.landedOnTile) entity.landedOnTile(tile);
          }

          this.addEntity(new LandingParticle(this.player.pos));
          this.addEntity(new LandingParticle(this.player.pos));
          this.addEntity(new LandingParticle(this.player.pos));
          this.addEntity(new LandingParticle(this.player.pos));

          this.lightUpSlamTiles = 12;

          this.fallingDirtCounter = 4;
      }

      spawnFallingDirt() {
          for (let i = 0; i < this.superslamTiles.length; i++) {
              let slam = this.superslamTiles[i];
              if (!this.tileIsPassable(slam.q1, slam.r)) {
                  let x = (slam.q1 + Math.random() * (slam.q2 + 1 - slam.q1)) * TILE_SIZE;
                  let y = slam.r * TILE_SIZE + TILE_SIZE + 1;
                  this.addEntity(new FallingDirtParticle({ x: x, y: y }));
              }
          }
      }

      rescueLittlePig() {
          this.littlePigsRescued++;

          if (this.littlePigsRescued === this.littlePigs) {
              if (game.levelScreen.player.recording) {
                  game.lastReplay = game.levelScreen.player.recording;
              }
              game.nextLevel++;
              game.screens.pop();
              game.scores[this.levelNumber].time = this.t;
              game.scores[this.levelNumber].enemiesAlive = this.enemiesAlive;
          }
      }

      addEntity(entity) {
          if (!entity.z) {
              entity.z = 1;
          }

          for (let i = 0; i < this.entities.length; i++) {
              if (this.entities[i].z > entity.z) {
                  this.entities.splice(i, 0, entity);
                  return;
              }
          }

          this.entities.push(entity);
      }

      addScreenShake(screenshake) {
          // This screen shake applies to the entire rendered screen, including GUI
          this.screenshakes.push(screenshake);
      }

      addTileShake(screenshake, originQR) {
          let tiles = [];

          for (let q = originQR.q; q >= 0; q--) {
              if (this.tileIsPassable(q, originQR.r - 1) && !this.tileIsPassable(q, originQR.r)) {
                  tiles.push({ q: q, r: originQR.r });
              } else {
                  break;
              }
          }
          for (let q = originQR.q + 1; q < this.tiles[0].length; q++) {
              if (this.tileIsPassable(q, originQR.r - 1) && !this.tileIsPassable(q, originQR.r)) {
                  tiles.push({ q: q, r: originQR.r });
              } else {
                  break;
              }
          }

          this.tileshakes.push({
              screenshake: screenshake,
              tiles: tiles,
              s: 0
          });
      }

      extractSuperslamTiles(originQR) {
          let r = originQR.r;
          let q1 = originQR.q;
          let q2 = originQR.q;

          for (let q = originQR.q; q >= 0; q--) {
              if (this.tileIsPassable(q, originQR.r + 1) && !this.tileIsPassable(q, originQR.r)) {
                  q1 = q;
              } else {
                  break;
              }
          }
          for (let q = originQR.q + 1; q < this.tiles[0].length; q++) {
              if (this.tileIsPassable(q, originQR.r + 1) && !this.tileIsPassable(q, originQR.r)) {
                  q2 = q;
              } else {
                  break;
              }
          }

          return {
              r: r,
              q1: q1,
              q2: q2
          };
      }

      spawnClouds() {
          let clouds = this.entities.filter(entity => entity instanceof CloudParticle).length;
          if (clouds < 1) {
              this.addEntity(new CloudParticle());
              this.lastCloud = this.t;
          }

          if (this.t - this.lastCloud > 60 * 5 && Math.random() < 0.01) {
              this.addEntity(new CloudParticle());
              this.lastCloud = this.t;
          }
      }
  }

  // Game


  /**
   * Game state.
   */
  class Game {
      init() {
          Sprite.loadSpritesheet(() => {
              Viewport.init();
              Sprite.init();
              Text.init();
              Input.init();
              Audio.init();

              Camera.init();

              window.addEventListener('blur', () => this.pause());
              window.addEventListener('focus', () => this.unpause());

              this.reset();
              this.start();
          });
      }

      reset() {
          this.scenes = [];
          this.lastFrame = 0;
          this.nextLevel = 0;

          this.scores = [
              { time: 300 * 60, enemiesAlive: 10 },
              { time: 300 * 60, enemiesAlive: 10 },
              { time: 300 * 60, enemiesAlive: 10 },
              { time: 300 * 60, enemiesAlive: 10 }
          ];

          this.scenes.push(new IntroScene());
      }

      start() {
          this.frame = 0;
          this.framestamps = [0];
          this.update();
          window.requestAnimationFrame((xyz) => this.onFrame(xyz));
      }

      onFrame(currentms) {
          let delta = (currentms - this.lastFrame) - (1000 / FPS);

          if (delta >= 0) {
              this.frame++;
              this.lastFrame = currentms - delta;
              Viewport.resize();
              this.update();
              this.draw(Viewport.ctx);

              // this.framestamps.push(currentms);
              // if (this.framestamps.length >= 120) {
              //     this.framestamps.shift();
              // }
              // this.fps = 1000 / ((this.framestamps[this.framestamps.length - 1] - this.framestamps[0]) / this.framestamps.length);
          }
          window.requestAnimationFrame((xyz) => this.onFrame(xyz));
      }

      update() {
          // Gather user input
          Input.update();

          // Handle special keys that are screen-independent
          if (Input.pressed[Input.Action.MUSIC_TOGGLE]) {
              Audio.musicEnabled = !Audio.musicEnabled;
          }
          if (Input.pressed[Input.Action.SFX_TOGGLE]) {
              Audio.sfxEnabled = !Audio.sfxEnabled;
          }

          // Hand off control to the current "screen" (for example, game screen or menu)
          if (this.scenes.length === 0) {
              this.scenes.push(new GameScene());
          }
          this.scene = this.scenes[this.scenes.length - 1];
          this.scene.update();

          // Do per-frame audio updates
          Audio.update();
      }

      draw() {
          // Reset canvas transform and scale
          Viewport.ctx.setTransform(1, 0, 0, 1, 0, 0);
          Viewport.ctx.scale(Viewport.scale, Viewport.scale);

          this.scene.draw();

          Text.drawText(Viewport.ctx, String(this.fps), 15, 15, 1, Text.white);

          Viewport.ctx.fillStyle = 'black';
          Viewport.ctx.fillRect(50, 50, 10, 10);
      }

      pause() {
          if (this.paused) return;
          this.paused = true;
          Audio.pause();
      }

      unpause() {
          if (!this.paused) return;
          this.paused = false;
          Audio.unpause();
      }

      restartLevel() {
          this.scenes.pop();
      }

      speedrunScore() {
          let score = 100000;

          for (let i = 0; i < this.scores.length; i++) {
              score -= this.scores[i].time;
              score -= this.scores[i].enemiesAlive * 5 * 60;
          }

          let scoreText = String(score);
          if (scoreText.length > 3) {

              scoreText = scoreText.slice(0, scoreText.length - 3) + ',' + scoreText.slice(scoreText.length - 3);
          }

          return scoreText;
      }
  }

  const game = new Game();

  /**
   * Create and launch game.
   */
  game.init();

})();</script>